<!DOCTYPE html>
<html>
<head>
    <title>Untitled Document</title>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="keywords" content="">
	<script src="js/jquery-3.2.1.min.js"></script>
<!--    <link rel="stylesheet" type="text/css" href="css/nav.css">-->
	    <script src="js/nav.js"></script>
    <script src="js/jquery.form.js"></script>
	<style>
        #wrap{
            margin: 0 0 0 125px;
        }
		ul {
			list-style: none;
		}
		#contentListWrap {
			background-color: bisque;
			height: 330px;
		}
		#contentTitleWrapUl li span, #contentListWrapUl li span {
			display: inline-block;
		}
		#contentTitleWrapUl {
			background-color: aliceblue;
		}
		#contentListWrapUl {
			border: 1px solid black;
		}
		span {
			border: 1px solid red;
		}
		.listNum {
			width: 60px;
		}
		.listCate {
			width: 100px;
		}
		.listTitle {
			width: 250px;
		}
		.listWriter {
			width: 80px;
		}
		.listDate {
			width: 50px;
		}
		.listViewNum {
			width: 70px;
		}
	</style>
	<style>
     html, body {
       margin: 0;
       padding: 0;
   }
   
   #wrap {
       display: block;
   }
   
   .left_nav {
       position: fixed;
       top: 0;
       left: 0;
       display: inline-block;
       width: 120px;
       background-color: #6534ff;
       height: 100%;
   }
   
   .nav_ul {
       margin: 0;
       padding: 0px;
       list-style: none;
       text-align: center;
   }
   
   .nav_li {
       cursor: pointer;
   }
   
   #logout > li:hover,
   #nav_menu > li:hover {
       background-color: #62bcfa;
   }
   
   #user_Id {
       color: #FFFFFF;
   }
   
   .nav_text {
       text-decoration: none;
       color: #FFFFFF;
       font-family: sans-serif;
       font-size: 20px;
       display: block;
       padding: 14px 0;
   }
   
   #userInfo {
       display: block;
       height: 120px;
   }
   
   #user_Img {
       width: 60px;
       height: 60px;
       border-radius: 60px;
   }
   
   #user_Img_Cover {
       display: block;
       width: 60px;
       margin: 30px auto 0 auto;
   }
   
   #logout {
       position: absolute;
       bottom: 10px;
       width: 100%;
   }
   
    </style>
	
	<script>

        
         nowPage = 0;
    nowPage2 = 0;
    // 세션 확인 

        
    getNextFriends(1);
    //친구들 호출 무식하게 호출
    function getNextFriends(page) {
        nowPage = page;
        var notfind = '0';
        $.ajax ({
            type : 'post',
            url : 'admingGetQnaList.do',
            dataType : "json",
            data: {page : page , val : notfind } ,
            success : function(data) {
                console.log(data);
                var userInfos = "";
              for(var i=0; i< data.length;i++){
                    var num = page*10+i+1-10;
                    if(i%2 !=0){
                        userInfos += '<li style="background-color: #AFBACB;">';
                    }else{
                        userInfos += '<li>';    
                    }
                    
                    userInfos += '<span class="listNum">'+num+'</span>';
                    userInfos += '<span class="listCate">'+ data[i].QNA_CATEGORY +'</span>';
                    userInfos += '<span class="listTitle">'+ data[i].QNA_TITLE +'</span>'
//                    userInfos += '<div class="countText">게시글 방번호 :</div>';
//                    userInfos += '<span class="tdCon">'+ data[i].QNA_CONTENTS +'</span>';
                    userInfos += '<span class="listWriter">'+ data[i].MEMBER_ID +'</span>';
                    userInfos += '<span class="listDate">'; 
                    userInfos += data[i].QNA_DATE.substring(0,10);
                    userInfos += '</span>';
//                    userInfos += '<span class="tdan"><textarea rows="4" cols="20" style="resize :none;">';
//                    var reply = data[i].QNA_REPLY;
//                    if(reply != null && reply != ""){
//                        userInfos += reply;    
//                    }
//                    userInfos += '</textarea></span>';
//                    userInfos += '<span class="tdBt2"> <input type="button" value="답변" id="'+data[i].QNA_ID+'"  onclick="replyBtn(this)"/> </span>';
                    userInfos += '</li>';
                }
                $('#contentListWrapUl').html(userInfos);
                
                var page_viewList = Paging(data[0].memberCount, 10, 10 ,nowPage, "PagingView");
                $("#addPageCover").empty().html(page_viewList);

                
            }, error: function (req) {
                
                console.log(req);
            }
        });
    }
    
        //페이지 나타내기
    Paging = function(totalCnt, dataSize, pageSize, pageNo, token){
        totalCnt = parseInt(totalCnt);// 전체레코드수 dataSize = parseInt(dataSize);
        // 페이지당 보여줄 데이타수 
        pageSize = parseInt(pageSize); // 페이지 그룹 범위 1 2 3 5 6 7 8 9 10 
        pageNo = parseInt(pageNo); // 현재페이지 
        var html = new Array(); 
        if(totalCnt == 0){
            return ""; 
        } // 페이지 카운트 
        var pageCnt = totalCnt % dataSize; 
        if(pageCnt == 0){
            pageCnt = parseInt(totalCnt / dataSize);
        }else{
            pageCnt = parseInt(totalCnt / dataSize) + 1;
        } 
        var pRCnt = parseInt(pageNo / pageSize);
        if(pageNo % pageSize == 0){
            pRCnt = parseInt(pageNo / pageSize) - 1; 
        } //이전 화살표
        if(pageNo > pageSize){ 
            var s2; if(pageNo % pageSize == 0){
                s2 = pageNo - pageSize; 
            }else{
                    s2 = pageNo - pageNo % pageSize; 
                } 
            html.push('<a href=javascript:goPaging_' + token + '("');
            html.push(s2); html.push('");>');
            html.push('◀'); html.push("</a>"); 
        }else{
            html.push('<a href="#">\n');
            html.push('◀'); html.push('</a>'); 
            
        } //paging Bar 
        for(var index=pRCnt * pageSize + 1;index<(pRCnt + 1)*pageSize + 1;index++){
            if(index == pageNo){ 
                html.push('<strong>');
                html.push(index);
                html.push('</strong>'); 
            }else{ 
                html.push('<a href=javascript:goPaging_' + token + '("');
                html.push(index); html.push('");>');
                html.push(index); html.push('</a>'); 
            } 
            if(index == pageCnt){ 
                break;
            }else html.push('|'); 
        } //다음 화살표 
        if(pageCnt > (pRCnt + 1) * pageSize){
            html.push('<a href=javascript:goPaging_' + token + '("');
            html.push((pRCnt + 1)*pageSize+1); 
            html.push('");>'); html.push('▶'); 
            html.push('</a>');
        }else{
            html.push('<a href="#">');
            html.push('▶'); html.push('</a>');
        } 
        return html.join("");
    }

    var goPaging_PagingView = function(cPage){
        getNextFriends(cPage);
    };
    
    //검색으로 실시간 호출
    function getNextFriends2(page) {
        nowPage = page;
        var pages =1;
        if(page >pages){
            pages = page
        }
        $.ajax ({
            type : 'post',
            url : 'admingGetQnaList.do',
            dataType : "json",
            data: {page : pages ,val : $('#findMember').val()} ,
            success : function(data) {
                console.log(data);
                var userInfos = "";
                for(var i=0; i< data.length;i++){
                    var num = pages*10+i+1-10;
                    if(i%2 !=0){
                        userInfos += '<li style="background-color: #AFBACB;">';
                    }else{
                        userInfos += '<li>';    
                    }
                    
                    userInfos += '<span class="tdNum">'+num+'</span>';
                    userInfos += '<span class="tdKind">'+ data[i].QNA_CATEGORY +'</span>';
                    userInfos += '<span class="tdtit">'+ data[i].QNA_TITLE +'</span>'
                    userInfos += '<div class="countText">게시글 방번호 :</div>';
                    userInfos += '<span class="tdCon">'+ data[i].QNA_CONTENTS +'</span>';
                    userInfos += '<span class="tdId">'+ data[i].MEMBER_ID +'</span>';
                    userInfos += '<span class="tdBi">'; 
                    userInfos += data[i].QNA_DATE.substring(0,10);
                    userInfos += '</span>';
                    userInfos += '<span class="tdan"><textarea rows="4" cols="20" style="resize :none;">';
                    var reply = data[i].QNA_REPLY;
                    if(reply != null && reply != ""){
                        userInfos += reply;    
                    }
                    userInfos += '</textarea></span>';
                    userInfos += '<span class="tdBt2"> <input type="button" value="답변" id="'+data[i].QNA_ID+'"  onclick="replyBtn(this)"/> </span>';
                    userInfos += '</li>';
                }
                $('#contentListWrapUl').html(userInfos);

                var page_viewList2 = Paging2(data[0].memberCount, 10, 10 ,pages, "S");
                $("#addPageCover").empty().html(page_viewList2);


            }, error: function (req) {

                console.log(req);
            }
        });
    }
    
            //페이지 나타내기
    Paging2 = function(totalCnt, dataSize, pageSize, pageNo, token){
        totalCnt = parseInt(totalCnt);// 전체레코드수 dataSize = parseInt(dataSize);
        // 페이지당 보여줄 데이타수 
        pageSize = parseInt(pageSize); // 페이지 그룹 범위 1 2 3 5 6 7 8 9 10 
        pageNo = parseInt(pageNo); // 현재페이지 
        var html = new Array(); 
        if(totalCnt == 0){
            return ""; 
        } // 페이지 카운트 
        var pageCnt = totalCnt % dataSize; 
        if(pageCnt == 0){
            pageCnt = parseInt(totalCnt / dataSize);
        }else{
            pageCnt = parseInt(totalCnt / dataSize) + 1;
        } 
        var pRCnt = parseInt(pageNo / pageSize);
        if(pageNo % pageSize == 0){
            pRCnt = parseInt(pageNo / pageSize) - 1; 
        } //이전 화살표
        if(pageNo > pageSize){ 
            var s2; if(pageNo % pageSize == 0){
                s2 = pageNo - pageSize; 
            }else{
                    s2 = pageNo - pageNo % pageSize; 
                } 
            html.push('<a href=javascript:goPaging_' + token + '("');
            html.push(s2); html.push('");>');
            html.push('◀'); html.push("</a>"); 
        }else{
            html.push('<a href="#">\n');
            html.push('◀'); html.push('</a>'); 
            
        } //paging Bar 
        for(var index=pRCnt * pageSize + 1;index<(pRCnt + 1)*pageSize + 1;index++){
            if(index == pageNo){ 
                html.push('<strong>');
                html.push(index);
                html.push('</strong>'); 
            }else{ 
                html.push('<a href=javascript:goPaging_' + token + '("');
                html.push(index); html.push('");>');
                html.push(index); html.push('</a>'); 
            } 
            if(index == pageCnt){ 
                break;
            }else html.push('|'); 
        } //다음 화살표 
        if(pageCnt > (pRCnt + 1) * pageSize){
            html.push('<a href=javascript:goPaging_' + token + '("');
            html.push((pRCnt + 1)*pageSize+1); 
            html.push('");>'); html.push('▶'); 
            html.push('</a>');
        }else{
            html.push('<a href="#">');
            html.push('▶'); html.push('</a>');
        } 
        return html.join("");
    }

    var goPaging_S = function(cPage){
        getNextFriends2(cPage);
    };
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
		// 건의사항 첫 페이지 리스트 뽑기
		function getList(page) {
        nowPage = page;
        var notfind = '0';
        $.ajax ({
            type : 'post',
            url : 'QnaGetList.do',
            dataType : "json",
            data: {page : page , val : notfind } ,
            success : function(data) {
                console.log(data);
                var userInfos = "";
                for(var i=0; i< data.length;i++){
                    var num = page*10+i+1-10;
                    if(i%2 !=0){
                        userInfos += '<li>';
                    }else{
                        userInfos += '<li>';    
                    }
                    
                    userInfos += '<span>'+num+'</span>';
                    userInfos += '<span>'+ data[i].QNA_CATEGORY +'</span>';
                    userInfos += '<span>'+ data[i].QNA_TITLE +'</span>';
                    userInfos += '<span>'+ data[i].MEMBER_ID +'</span>';
                    userInfos += '<span>'; 
                    userInfos += data[i].QNA_DATE.substring(0,10);
                    userInfos += '</span>';
					// 조회수 추가 해야함
                    userInfos += '</li>';
                }
                $('#contentListWrapUl').html(userInfos);
                
//				페이지 수 생기는 부분 추후 수정
//                var page_viewList = Paging(data[0].QNA_ID, 10, 10 ,nowPage, "PagingView");
//                $("#addPageCover").empty().html(page_viewList);

                
            }, error: function (req) {
                
                console.log(req);
            }
        });
    }
		
		
		// 건의사항 검색 후 결과 .... 연결만 해놓음
		function qnaSearchEnter(page) {
			nowPage = page;
        var pages =1;
        if(page >pages){
            pages = page;
        }
		$.ajax ({
			type : 'post',
			url : 'QnaGetList.do',
			dataType : "json",
			data: {searchCategory : $('#searchCategory').val(), page : pages ,val : $('#searchText').val()} ,
			success : function(data) {
				console.log(data);
				var userInfos = "";
					for(var i=0; i< data.length;i++){
						var num = pages*10+i+1-10;
						if(i%2 !=0){
							userInfos += '<li>';
						}else{
							userInfos += '<li>';    
						}

						userInfos += '<span>'+num+'</span>'; // 글번호
						userInfos += '<span>'+ data[i].QNA_CATEGORY +'</span>'; // 카테고리
						userInfos += '<span>'+ data[i].QNA_TITLE +'</span>'; // 제목
						userInfos += '<span>'+ data[i].MEMBER_ID +'</span>'; // 작성자
						userInfos += '<span>'; 
						userInfos += data[i].QNA_DATE.substring(0,10); // 날짜
						userInfos += '</span>';
						// 조회수 추가 해야함
						userInfos += '</li>';
					}
					$('#inputMemberinfo').html(userInfos);
				
//				페이지 수 생기는 부분 추후 수정
//				var page_viewList2 = Paging2(data[0].QNA_ID, 10, 10 ,pages, "S");
//				$("#addPageCover").empty().html(page_viewList2);


			}, error: function (req) {

				console.log(req);
			}
		});
		}
		
	</script>
</head>
<body>
    <div>
    <!--  네브바 입니다  -->
    <nav class="left_nav">
        <div id="userInfo">
            <ul id="user_Img_Cover" class="nav_ul" onclick="location.href='myInfo.html'">
                <li class="nav_li">
                    <img id="user_Img" src=""/>
                </li>
                <li class="nav_li">
                    <div id="user_Id"></div>
                </li>
            </ul>
        </div>
        <ul class="nav_ul" id="nav_menu">
            <li class="nav_li"><a class="nav_text"  href="home.html">홈</a></li>
            <li class="nav_li"><a class="nav_text" href="myCalendar.html">개인 캘린더</a></li>
            <li class="nav_li"><a class="nav_text" href="groupList.html">단체 캘린더</a></li>
            <li class="nav_li"><a class="nav_text" href="friendList.html">친구 목록</a></li>
            <li class="nav_li"><a class="nav_text" style="background-color:#182D42;" href="qnaList.html">문의 하기</a></li>
        </ul>
        <ul id="logout" class="nav_ul" onclick="logout()">
            <li class="nav_li"><a class="nav_text" onclick="logout();">로그아웃</a></li>
        </ul>
    </nav>


	
	<div id="wrap">
        <div class="container">
        <div>
            <h4>문의사항 페이지</h4>
        </div>
		<div id="contentTitleWrap">
			<ul id="contentTitleWrapUl">
				<li>
					<span class="listNum">글번호</span>
					<span class="listCate">카테고리</span>
					<span class="listTitle">제목</span>
					<span class="listWriter">작성자</span>
					<span class="listDate">날짜</span>
					<span class="listViewNum">조회수</span>
				</li>
			</ul>
		</div>
		<div id="contentListWrap">
		글 목록 예시			
			<ul id="contentListWrapUl">
<!--
	여기에다가 추가 할거야
				<li>
					<span class="listNum">1</span>
					<span class="listCate">불만사항</span>
					<span class="listTitle">너무 불편해요.</span>
					<span class="listWriter">최승우</span>
					<span class="listDate">06-18</span>
					<span class="listViewNum">0</span>
				</li>
-->

			</ul>
		</div>
		<div>
			<input type="button" value="글쓰기" onclick="location.href='qnaWrite.html'"/>
			</div>
            
            
            
            
                    <div id="pageChoiceCover">
                        <span id="addPageCover">
                        </span>
                    </div>
            
            
            
		<form id="qnaListForm" action="SearchQna.do" method="post">	
			<div>
				<select name="searchCategory">
					<option value="1">제목</option>
					<option value="2">글 내용</option>
					<option value="3">글 작성자</option>
				</select>
				<input type="text" name="searchBox" id="searchText"/>
				<input type="button" value="검색" onclick="qnaSearchEnter()"/>
			</div>
		</form>
    	</div>
	</div>
	</div>

</body>
</html>
