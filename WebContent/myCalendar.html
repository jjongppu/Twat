<!DOCTYPE html>
<html>

<head>
    <title>개인 캘렌더</title>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="keywords" content="">
<!--    <link rel="stylesheet" type="text/css" href="css/myCalendar.css">-->
<!--    <link rel="stylesheet" type="text/css" href="css/myCalendarCSSver2.css"> -->
<!--    <link rel="stylesheet" type="text/css" href="css/myCalendarCSSver3.css">-->
    <link rel="stylesheet" type="text/css" href="css/swiper.min.css">
    <link rel="stylesheet" type="text/css" href="css/myCalendarCSSver4.css">
<!--    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>-->
<!--    <link rel="stylesheet" type="text/javascript" href="js/myCalendar.js">-->
<!--    <script type="text/javascript" src="js/myCalendar.js"></script>-->
<!--    <link rel="stylesheet" type="text/css" href="css/nav.css">-->
        <link href="http://fonts.googleapis.com/earlyaccess/hanna.css" rel="stylesheet">
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/nav.js"></script>
<!--    <script src="js/swiper.jquery.min.js"></script>-->
    <script src="js/swiper.jquery.min.js"></script>
    <script language="javascript" type="text/javascript">
    //  gfnToday() : 해당 PC의 오늘 날짜를 가져온다. String.
    //  gfnTodayTime() : 해당 PC의 오늘 날짜+시간를 가져온다. String.
    //  gfnCurrentTime() : 해당 PC의 현재시간를 가져온다. String.
    //  gfnAddDate(date, nOffSet) : 입력된 날자에 OffSet 으로 지정된 만큼의 일을 더한다.
    //                              Date Type을 String으로 변환.
    //                     argument    : date ('yyyyMMdd' 형태로 표현된 날자)
    //                                  nOffSet (날짜로부터 증가 감소값. 지정하지 않으면 Default Value = 1 로 적용됩니다)
    //
    //  gfnAddMonth(date, nOffSet) : 입력된 날자에 OffSet 으로 지정된 만큼의 달을 더한다.
    //
    //  gfnDatetime(nYear, nMonth, nDate) : MiPlatform에서 사용하던 Datetime형식으로 변환
    //          nYear (년도), nMonth (월), nDate (일)
    //
    //
    //  gfnGetDiffDay(sFdate, sTdate) : gfnGetDiffDay("20090808", "20091001")
    //         sFdate : 시작일자,  sTdate : 종료일자        2개의 날짜간의 Day count.
    //
    //  gfnDateCheck(sDate) : 날짜에 대한 형식 체크
    //          sDate : 검사일자
    //
    //  gfnGetDay(sDate) : 입력된 날자로부터 요일을 구함
    //      sDate  8자리 형식으로된 날짜. yyyyMMdd의 형식으로 입력됩니다.
    //  요일에 따른 숫자,   0 = 일요일 ~ 6 = 토요일 로 대응됩니다., 오류가 발생할 경우 -1이 Return됩니다.

    // swiper
    var swip;

//    var oScript = document.createElement("script");
//    oScript.type = "text/javascript";
//    oScript.charset = "utf-8";
//    oScript.src = "https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js";
//    //oScript.src = "WebContent/js/jquery-3.2.1.min.js";
//    //oScript.src = "/js/jquery-3.2.1.min.js";
//    document.getElementsByTagName("head")[0].appendChild(oScript);

    var scheSet = new Set(); // 일정 잡기 저장용
    var birthSet = new Set(); // 생일자 저장용
    var scheduleSet = new Set(); // 일정(확정) 저장용
    var voteSet = new Set(); // 일정(미확정) 저장용
    var groupScheduleSet = new Set(); // 전체 일정 저장용
    var initDay = new Date();
    var cal_date = "";
    /*음력 알고리즘..시작*/
    function gfnRight(strString, nSize) {
        var nStart = String(strString).length;
        var nEnd = Number(nStart) - Number(nSize);
        var rtnVal = strString.substring(nStart, nEnd);
        return rtnVal;
    }

    function gfnIsEmpty(val) {
        var sVal = new String(val);
        val = new String(val);
        if (val == null || val == "null" || sVal.trim().length <= 0 || escape(val) == "undefined") {
            return true;
        } else {
            return false;
        }
    }
    /*******************************************************************************
     * Function명 : gfnToday
     * 설명          : 해당 PC의 오늘 날짜를 가져온다.
     * parameter  : None
     * return        : string
     ******************************************************************************/
    function gfnToday() {
        var strToday = "";
        var objDate = new Date();
        var strToday = objDate.getFullYear() + "";
        strToday += gfnRight("0" + (objDate.getMonth() + 1), 2);
        strToday += gfnRight("0" + objDate.getDate(), 2);
        return strToday;
    }
    /*******************************************************************************
     * Function명 : gfnTodayTime
     * 설명       : 해당 PC의 오늘 날짜+시간를 가져온다.
     * parameter : None
     * return         : string
     ******************************************************************************/
    function gfnTodayTime() {
        var strToday = "";
        var objDate = new Date();
        var strToday = objDate.getFullYear() + "";
        strToday += gfnRight("0" + (objDate.getMonth() + 1), 2);
        strToday += gfnRight("0" + objDate.getDate(), 2);
        strToday += gfnRight("0" + objDate.getHours(), 2);
        strToday += gfnRight("0" + objDate.getMinutes(), 2);
        strToday += gfnRight("0" + objDate.getSeconds(), 2);
        return strToday;
    }
    /*******************************************************************************
     * Function명: gfnCurrentTime
     * 설명      : 해당 PC의 현재시간를 가져온다.
     * parameter : None
     * return    : string
     ******************************************************************************/
    function gfnCurrentTime() {
        var strCurrentTime = "";
        var objDate = new Date();
        strCurrentTime += gfnRight("0" + objDate.getHours(), 2);
        strCurrentTime += gfnRight("0" + objDate.getMinutes(), 2);
        strCurrentTime += gfnRight("0" + objDate.getSeconds(), 2);
        return strCurrentTime;
    }
    /**********************************************************************************
     * 함수명      : gfnAddDate
     * 설명        : 입력된 날자에 OffSet 으로 지정된 만큼의 일을 더한다.
     *               Date Type을 String으로 변환
     * argument    : date ('yyyyMMdd' 형태로 표현된 날자)
     *               nOffSet (날짜로부터 증가 감소값. 지정하지 않으면 Default Value = 1 로 적용됩니다)
     * return Type : String
     * return 내용 : Date에 nOffset이 더해진 결과를 'yyyyMMdd'로 표현된 날자.
     **********************************************************************************/
    function gfnAddDate(date, nOffSet) {
        var nYear = parseInt(date.substr(0, 4));
        var nMonth = parseInt(date.substr(4, 2));
        var nDate = parseInt(date.substr(6, 2)) + nOffSet;
        return gfnDatetime(nYear, nMonth, nDate);
        //            aHoliday[0] = gfnLunar2Solar( "0" + (nYear-1) + "1230" ) + "설날";
        //            return gfnLunar2Solar( "0" + (nYear) + nMonth + nDate );
    }
    /**********************************************************************************
     * 함수명      : gfnAddMonth
     * 설명        : 입력된 날자에 OffSet 으로 지정된 만큼의 달을 더한다.
     *               Date Type을 String으로 변환
     * argument    : date ('yyyyMMdd' 형태로 표현된 날자)
     *               nOffSet (날짜로부터 증가 감소값. 지정하지 않으면 Default Value = 1 로 적용됩니다)
     * return Type : String
     * return 내용 : Date에 nOffset이 더해진 결과를 'yyyyMMdd'로 표현된 날자.
     **********************************************************************************/
    function gfnAddMonth(date, nOffSet) {
        var nYear = parseInt(date.substr(0, 4));
        var nMonth = parseInt(date.substr(4, 2)) + nOffSet;
        var nDate = parseInt(date.substr(6, 2));
        return gfnDatetime(nYear, nMonth, nDate);
    }
    /**********************************************************************************
     * 함수명      : gfnDatetime
     * 설명        : MiPlatform에서 사용하던 Datetime형식으로 변환
     *               Date Type을 String으로 변환
     * argument    : nYear (년도)
     *               nMonth (월)
     *               nDate (일)
     * return Type : String
     * return 내용 : 조합한 날짜를 리턴
     **********************************************************************************/
    function gfnDatetime(nYear, nMonth, nDate) {
        if (nYear.toString().trim().length >= 5) {
            var sDate = new String(nYear);
            var nYear = sDate.substr(0, 4);
            var nMonth = sDate.substr(4, 2);
            var nDate = ((sDate.substr(6, 2) == "") ? 1 : sDate.substr(6, 2));
            var nHours = ((sDate.substr(8, 2) == "") ? 0 : sDate.substr(8, 2));
            var nMinutes = ((sDate.substr(10, 2) == "") ? 0 : sDate.substr(10, 2));
            var nSeconds = ((sDate.substr(12, 2) == "") ? 0 : sDate.substr(12, 2));
            var objDate = new Date(parseInt(nYear), parseInt(nMonth) - 1, parseInt(nDate), parseInt(nHours), parseInt(nMinutes), parseInt(nSeconds));
        } else {
            var objDate = new Date(parseInt(nYear), parseInt(nMonth) - 1, parseInt(((nDate == null) ? 1 : nDate)));
        }
        var strYear = objDate.getYear().toString();
        var strMonth = (objDate.getMonth() + 1).toString();
        var strDate = objDate.getDate().toString();
        if (strMonth.length == 1) strMonth = "0" + strMonth;
        if (strDate.length == 1) strDate = "0" + strDate;
        return strYear + strMonth + strDate;
    }
    /******************************************************************************
     * Function명 : gfnGetDiffDay
     * 사용법 : gfnGetDiffDay("20090808", "20091001")
     * 설명       : 2개의 날짜간의 Day count
     * Params     : sFdate   시작일자
     *              sTdate   종료일자
     * Return     : 양 일자간의 Day count
     ******************************************************************************/
    function gfnGetDiffDay(sFdate, sTdate) {
        sFdate = new String(sFdate);
        sFdate = sFdate.replace(" ", "").replace("-", "").replace("/", "");
        sTdate = new String(sTdate);
        sTdate = sTdate.replace(" ", "").replace("-", "").replace("/", "");
        sFdate = gfnLeft(sFdate, 8);
        sTdate = gfnLeft(sTdate, 8);
        if (sFdate.length != 8 || sTdate.length != 8 || isNumeric(sFdate) == false || isNumeric(sTdate) == false || gfnGetDay(sFdate) == -1 || gfnGetDay(sTdate) == -1) {
            return null;
        }
        var nDiffDate = gfnStrToDate(sTdate) - gfnStrToDate(sFdate);
        var nDay = 1000 * 60 * 60 * 24;
        nDiffDate = parseInt(nDiffDate / nDay);
        if (nDiffDate < 0) {
            nDiffDate = nDiffDate - 1;
        } else {
            nDiffDate = nDiffDate + 1;
        }
        return nDiffDate;
    }
    /******************************************************************************
     * Function명 : gfnDateCheck
     * 설명       : 날짜에 대한 형식 체크
     * Params     : sDate   검사일자
     * Return     : 유효성반환 (날짜형식이 아닐경우 FLASE)
     ******************************************************************************/
    function gfnDateCheck(sDate) {
        sDate = sDate.replace(" ", "").replace("-", "").replace("/", "");
        if (isNumeric(sDate) == false || gfnGetDay(sDate) == -1 /*|| datetime(sDate) == datetime("00000101")*/ ) {
            return false;
        }
        return true;
    }
    /******************************************************************************
     * Function명 : gfnGetDay
     * 설명       : 입력된 날자로부터 요일을 구함
     * Params     : sDate  8자리 형식으로된 날짜. yyyyMMdd의 형식으로 입력됩니다.
     * Return     : 요일에 따른 숫자.
     *              0 = 일요일 ~ 6 = 토요일 로 대응됩니다.
     *              오류가 발생할 경우 -1이 Return됩니다.
     ******************************************************************************/
    function gfnGetDay(sDate) {
        var objDate = gfnStrToDate(sDate);
        return objDate.getDay();
    }
    /*******************************************************************************
     * 함수명      : gfnStrToDate
     * 설명        : 반자를 전자로 변환하는 함수
     * argument    : sDate 8자리 형식으로된 날짜. yyyyMMdd의 형식으로 입력됩니다.
     * Return      : Date
     *******************************************************************************/
    function gfnStrToDate(sDate) {
        var nYear = parseInt(sDate.substr(0, 4));
        var nMonth = parseInt(sDate.substr(4, 2)) - 1;
        var nDate = parseInt(sDate.substr(6, 2));
        return new Date(nYear, nMonth, nDate);
    }
    /******************************************************************************
     * 2010.05.11. 권세준 추가 시작
     ******************************************************************************/
    /******************************************************************************
     * Function명 : gfnGetDayName
     * 설명       : 입력된 날자로부터 요일명을 구함
     * Params     : sDate  8자리 형식으로된 날짜. yyyyMMdd의 형식으로 입력됩니다.
     * Return     : 요일명
     ******************************************************************************/
    function gfnGetDayName(sDate) {
        var objDayName = new Array("일요일", "월요일", "화요일", "수요일", "목요일", "금요일", "토요일");
        var objDate = gfnGetDay(sDate);
        return objDayName[objDate];
    }
    /******************************************************************************
     * Function명 : gfnIsLeapYear
     * 설명       : 윤년여부 확인
     * Params     : sDate : yyyyMMdd형태의 날짜 ( 예 : "20121122" )
     * Return     : 
     *               - sDate가 윤년인 경우 = true
     *     - sDate가 윤년이 아닌 경우 = false
     *       - sDate가 입력되지 않은 경우 = false
     ******************************************************************************/
    function gfnIsLeapYear(sDate) {
        var ret;
        var nY;
        if (gfnIsEmpty(sDate)) return false;
        nY = parseInt(sDate.substring(0, 4), 10);
        if ((nY % 4) == 0) {
            if ((nY % 100) != 0 || (nY % 400) == 0) ret = true;
            else ret = false;
        } else ret = false;
        return ret;
    }
    /******************************************************************************
     * Function명 : gfnLastDateNum
     * 설명       : 해당월의 마지막 날짜를 숫자로 구하기
     * Params     : sDate : yyyyMMdd형태의 날짜 ( 예 : "20121122" )
     * Return     : 
     *               - 성공 = 마지막 날짜 숫자값 ( 예 : 30 )
     *     - 실패 = -1
     ******************************************************************************/
    function gfnLastDateNum(sDate) {
        var nMonth, nLastDate;
        if (gfnIsEmpty(sDate)) return -1;
        nMonth = parseInt(sDate.substr(4, 2), 10);
        if (nMonth == 1 || nMonth == 3 || nMonth == 5 || nMonth == 7 || nMonth == 8 || nMonth == 10 || nMonth == 12) nLastDate = 31;
        else if (nMonth == 2) {
            if (gfnIsLeapYear(sDate) == true) nLastDate = 29;
            else nLastDate = 28;
        } else nLastDate = 30;
        return nLastDate;
    }
    /******************************************************************************
     * Function명 : gfnLastDate
     * 설명       : 해당월의 마지막 날짜를 yyyyMMdd형태로 구하기 
     * Params     : sDate : yyyyMMdd형태의 날짜 ( 예 : "20121122" )
     * Return     : 
     *               - 성공 = yyyyMMdd형태의 마지막 날짜 ( 예 : "20121130" )
     *     - 실패 = ""
     ******************************************************************************/
    function gfnLastDate(sDate) {
        if (gfnIsEmpty(sDate)) return "";
        var nLastDate = gfnLastDateNum(sDate);
        return sDate.substr(0, 6) + nLastDate.toString();
    }
    /******************************************************************************
     * Function명 : gfnSolar2Lunar
     * 설명       : 양력을 음력으로 변환해주는 함수 (처리가능 기간  1841 - 2043년)
     * Params     : sDate : yyyyMMdd형태의 양력일자 ( 예 : "20121122" )
     * Return     : return값이 8자리가 아니고 9자리임에 주의
     *               - 성공 = Flag(1 Byte) + (yyyyMMdd형태의 음력일자)
     *        ( Flag : 평달 = "0", 윤달 = "1" )
     *       - 실패 = "" ( 1841 ~ 2043 범위 오류시 )
     ******************************************************************************/
    function gfnSolar2Lunar(sDate) {
        var sMd = "31,0,31,30,31,30,31,31,30,31,30,31";
        var aMd = new Array();
        var aBaseInfo = new Array();
        var aDt = new Array(); // 매년의 음력일수를 저장할 배열 변수
        var td; // 음력일을 계산하기 위해 양력일과의 차이를 저장할 변수
        var td1; // 1840년까지의 날수
        var td2; // 현재까지의 날수
        var mm; // 임시변수
        var nLy, nLm, nLd; // 계산된 음력 년, 월, 일을 저장할 변수
        var sLyoon; // 현재월이 윤달임을 표시
        if (gfnIsEmpty(sDate)) return "";
        sY = parseInt(sDate.substr(0, 4), 10);
        sM = parseInt(sDate.substr(4, 2), 10);
        sD = parseInt(sDate.substr(6, 2), 10);
        if (sY < 1841 || sY > 2043) return "";
        aBaseInfo = _SolarBase();
        aMd = sMd.split(",");
        if (gfnIsLeapYear(sDate) == true) aMd[1] = 29;
        else aMd[1] = 28;
        td1 = 672069; // 672069 = 1840 * 365 + 1840/4 - 1840/100 + 1840/400 + 23  //1840년까지 날수
        // 1841년부터 작년까지의 날수
        td2 = (sY - 1) * 365 + parseInt((sY - 1) / 4) - parseInt((sY - 1) / 100) + parseInt((sY - 1) / 400);
        // 전월까지의 날수를 더함
        for (i = 0; i <= sM - 2; i++) td2 = td2 + parseInt(aMd[i]);
        // 현재일까지의 날수를 더함
        td2 = td2 + sD;
        // 양력현재일과 음력 1840년까지의 날수의 차이
        td = td2 - td1 + 1;
        // 1841년부터 음력날수를 계산
        for (i = 0; i <= sY - 1841; i++) {
            aDt[i] = 0;
            for (j = 0; j <= 11; j++) {
                switch (parseInt(aBaseInfo[i * 12 + j])) {
                    case 1:
                        mm = 29;
                        break;
                    case 2:
                        mm = 30;
                        break;
                    case 3:
                        mm = 58; // 29 + 29
                        break;
                    case 4:
                        mm = 59; // 29 + 30
                        break;
                    case 5:
                        mm = 59; // 30 + 29
                        break;
                    case 6:
                        mm = 60; // 30 + 30
                        break;
                }
                aDt[i] = aDt[i] + mm;
            }
        }
        // 1840년 이후의 년도를 계산 - 현재까지의 일수에서 위에서 계산된 1841년부터의 매년 음력일수를 빼가면수 년도를 계산
        nLy = 0;
        do {
            td = td - aDt[nLy];
            nLy = nLy + 1;
        }
        while (td > aDt[nLy]);
        nLm = 0;
        sLyoon = "0"; // 현재월이 윤달임을 표시할 변수 - 기본값 평달
        do {
            if (parseInt(aBaseInfo[nLy * 12 + nLm]) <= 2) {
                mm = parseInt(aBaseInfo[nLy * 12 + nLm]) + 28;
                if (td > mm) {
                    td = td - mm;
                    nLm = nLm + 1;
                } else break;
            } else {
                switch (parseInt(aBaseInfo[nLy * 12 + nLm])) {
                    case 3:
                        m1 = 29;
                        m2 = 29;
                        break;
                    case 4:
                        m1 = 29;
                        m2 = 30;
                        break;
                    case 5:
                        m1 = 30;
                        m2 = 29;
                        break;
                    case 6:
                        m1 = 30;
                        m2 = 30;
                        break;
                }
                if (td > m1) {
                    td = td - m1;
                    if (td > m2) {
                        td = td - m2;
                        nLm = nLm + 1;
                    } else {
                        sLyoon = "1";
                    }
                } else {
                    break;
                }
            }
        }
        while (1);
        nLy = nLy + 1841;
        nLm = nLm + 1;
        nLd = td;
        return sLyoon + nLy + gfnRight("0" + nLm, 2) + gfnRight("0" + nLd, 2);
    }
    /******************************************************************************
     * Function명 : gfnLunar2Solar
     * 설명       : 음력을 양력으로 변환해주는 함수 (처리가능 기간  1841 - 2043년)
     * Params     : sDate : Flag(1 Byte)+yyyyMMdd형태의 음력일자 ( 예 : "020121122" ) ( Flag : 평달 = "0", 윤달 = "1" )
     * Return     : 
     *               - 성공 = yyyyMMdd형태의 양력일자
     *        ( Flag : 평달 = "0", 윤달 = "1" )
     *       - 실패 = null 
     *           - 1841 ~ 2043 범위 오류의 경우
     *           - sDate가 9자리가 아닐경우
     *           - sDate의 첫자리 Flag가 "0"도 아니고 "1"도 아닌 경우
     ******************************************************************************/
    function gfnLunar2Solar(sDate) {
        var sMd = "31,0,31,30,31,30,31,31,30,31,30,31";
        var aMd = new Array();
        var aBaseInfo = new Array();
        var nLy, nLm, nLd, sLflag; // 전해온 음력 인자값을 저장할 년, 월, 일, 윤달여부 임시변수
        var nSy, nSm, nSd; // 계산된 양력 년, 월, 일을 저장할 변수
        var y1, m1, i, j, y2, y3; // 임시변수 
        var leap;
        if (gfnIsEmpty(sDate)) return "";
        if (sDate.length != 9) return "";
        sLflag = sDate.substr(0, 1);
        nLy = parseInt(sDate.substr(1, 4), 10);
        nLm = parseInt(sDate.substr(5, 2), 10);
        nLd = parseInt(sDate.substr(7, 2), 10);
        if (nLy < 1841 || nLy > 2043) return "";
        if (sLflag != "0" && sLflag != "1") return "";
        aBaseInfo = _SolarBase();
        aMd = sMd.split(",");
        if (gfnIsLeapYear(sDate.substr(1, 8)) == true) aMd[1] = 29;
        else aMd[1] = 28;
        y1 = nLy - 1841;
        m1 = nLm - 1;
        leap = 0;
        if (parseInt(aBaseInfo[y1 * 12 + m1]) > 2) leap = gfnIsLeapYear(nLy + "0101");
        if (leap == 1) {
            switch (parseInt(aBaseInfo[y1 * 12 + m1])) {
                case 3:
                    mm = 29;
                    break;
                case 4:
                    mm = 30;
                    break;
                case 5:
                    mm = 29;
                    break;
                case 6:
                    mm = 30;
                    break;
            }
        } else {
            switch (parseInt(aBaseInfo[y1 * 12 + m1])) {
                case 1:
                    mm = 29;
                    break;
                case 2:
                    mm = 30;
                    break;
                case 3:
                    mm = 29;
                    break;
                case 4:
                    mm = 29;
                    break;
                case 5:
                    mm = 30;
                    break;
                case 6:
                    mm = 30;
                    break;
            }
        }
        td = 0;
        for (i = 0; i <= y1 - 1; i++) {
            for (j = 0; j <= 11; j++) {
                switch (parseInt(aBaseInfo[i * 12 + j])) {
                    case 1:
                        td = td + 29;
                        break;
                    case 2:
                        td = td + 30;
                        break;
                    case 3:
                        td = td + 58;
                        break;
                    case 4:
                        td = td + 59;
                        break;
                    case 5:
                        td = td + 59;
                        break;
                    case 6:
                        td = td + 60;
                        break;
                }
            }
        }
        for (j = 0; j <= m1 - 1; j++) {
            switch (parseInt(aBaseInfo[y1 * 12 + j])) {
                case 1:
                    td = td + 29;
                    break;
                case 2:
                    td = td + 30;
                    break;
                case 3:
                    td = td + 58;
                    break;
                case 4:
                    td = td + 59;
                    break;
                case 5:
                    td = td + 59;
                    break;
                case 6:
                    td = td + 60;
                    break;
            }
        }
        if (leap == 1) {
            switch (parseInt(aBaseInfo[y1 * 12 + m1])) {
                case 3:
                    mm = 29;
                    break;
                case 4:
                    mm = 29;
                    break;
                case 5:
                    mm = 30;
                    break;
                case 6:
                    mm = 30;
                    break;
            }
        }
        td = td + nLd + 22;
        if (sLflag == "1") {
            switch (parseInt(aBaseInfo[y1 * 12 + m1])) {
                case 3:
                    td = td + 29;
                    break;
                case 4:
                    td = td + 30;
                    break;
                case 5:
                    td = td + 29;
                    break;
                case 6:
                    td = td + 30;
                    break;
            }
        }
        y1 = 1840;
        do {
            y1 = y1 + 1;
            leap = gfnIsLeapYear(y1 + "0101");
            if (leap == 1) y2 = 366;
            else y2 = 365;
            if (td <= y2) break;
            td = td - y2;
        }
        while (1);
        nSy = y1;
        aMd[1] = y2 - 337;
        m1 = 0;
        do {
            m1 = m1 + 1;
            if (td <= parseInt(aMd[m1 - 1])) break;
            td = td - parseInt(aMd[m1 - 1]);
        }
        while (1);
        nSm = m1;
        nSd = td;
        y3 = nSy;
        td = y3 * 365 + parseInt(y3 / 4) - parseInt(y3 / 100) + parseInt(y3 / 400);
        for (i = 0; i <= nSm - 1; i++) td = td + parseInt(aMd[i]);
        td = td + nSd;
        return y3 + gfnRight("0" + nSm, 2) + gfnRight("0" + nSd, 2);
    }
    /******************************************************************************
     * Function명 : gfnGetHolidays
     * 설명       : 양력 nYear에 해당하는 년도의 법정 공휴일(양력) List 모두 구하기
     * Params     : nYear : nYear에 해당하는 년도 ( 예 : 2012 )
     * Return     : 
     *               - 성공 = 공휴일 List Array ==> 각 Array[i]="yyyyMMdd공휴일명" 으로 return된다.
     *        ( 예 : Array[0] = "20120101신정" )
     *       - 실패 = 빈 Array
     ******************************************************************************/
    function gfnGetHolidays(nYear) {
        var nYear;
        var aHoliday = new Array();
        if (gfnIsEmpty(nYear)) return aHoliday;
        aHoliday[0] = gfnLunar2Solar("0" + nYear + "0408") + "석가탄신일";
        aHoliday[1] = nYear + "0101" + "신정";
        aHoliday[2] = nYear + "0301" + "삼일절";
        aHoliday[3] = nYear + "0505" + "어린이날";
        aHoliday[4] = nYear + "0606" + "현충일";
        aHoliday[5] = nYear + "0815" + "광복절";
        aHoliday[6] = nYear + "1225" + "성탄절";
        return aHoliday.sort();
    }
    /******************************************************************************
     * Function명 : _SolarBase
     * 설명       : 각 월별 음력 기준 정보를 처리하는 함수(처리가능 기간  1841 - 2043년) 단, 내부에서 사용하는 함수임
     * Params     :  없음
     * Return     : 
     *               - 성공 = 음력 기준정보
     ******************************************************************************/
    function _SolarBase() {
        var kk;
        //1841
        kk = "1,2,4,1,1,2,1,2,1,2,2,1,";
        kk += "2,2,1,2,1,1,2,1,2,1,2,1,";
        kk += "2,2,2,1,2,1,4,1,2,1,2,1,";
        kk += "2,2,1,2,1,2,1,2,1,2,1,2,";
        kk += "1,2,1,2,2,1,2,1,2,1,2,1,";
        kk += "2,1,2,1,5,2,1,2,2,1,2,1,";
        kk += "2,1,1,2,1,2,1,2,2,2,1,2,";
        kk += "1,2,1,1,2,1,2,1,2,2,2,1,";
        kk += "2,1,2,3,2,1,2,1,2,1,2,2,";
        kk += "2,1,2,1,1,2,1,1,2,2,1,2,";
        //1851
        kk += "2,2,1,2,1,1,2,1,2,1,5,2,";
        kk += "2,1,2,2,1,1,2,1,2,1,1,2,";
        kk += "2,1,2,2,1,2,1,2,1,2,1,2,";
        kk += "1,2,1,2,1,2,5,2,1,2,1,2,";
        kk += "1,1,2,1,2,2,1,2,2,1,2,1,";
        kk += "2,1,1,2,1,2,1,2,2,2,1,2,";
        kk += "1,2,1,1,5,2,1,2,1,2,2,2,";
        kk += "1,2,1,1,2,1,1,2,2,1,2,2,";
        kk += "2,1,2,1,1,2,1,1,2,1,2,2,";
        kk += "2,1,6,1,1,2,1,1,2,1,2,2,";
        //1861
        kk += "1,2,2,1,2,1,2,1,2,1,1,2,";
        kk += "2,1,2,1,2,2,1,2,2,3,1,2,";
        kk += "1,2,2,1,2,1,2,2,1,2,1,2,";
        kk += "1,1,2,1,2,1,2,2,1,2,2,1,";
        kk += "2,1,1,2,4,1,2,2,1,2,2,1,";
        kk += "2,1,1,2,1,1,2,2,1,2,2,2,";
        kk += "1,2,1,1,2,1,1,2,1,2,2,2,";
        kk += "1,2,2,3,2,1,1,2,1,2,2,1,";
        kk += "2,2,2,1,1,2,1,1,2,1,2,1,";
        kk += "2,2,2,1,2,1,2,1,1,5,2,1,";
        //1871
        kk += "2,2,1,2,2,1,2,1,2,1,1,2,";
        kk += "1,2,1,2,2,1,2,1,2,2,1,2,";
        kk += "1,1,2,1,2,4,2,1,2,2,1,2,";
        kk += "1,1,2,1,2,1,2,1,2,2,2,1,";
        kk += "2,1,1,2,1,1,2,1,2,2,2,1,";
        kk += "2,2,1,1,5,1,2,1,2,2,1,2,";
        kk += "2,2,1,1,2,1,1,2,1,2,1,2,";
        kk += "2,2,1,2,1,2,1,1,2,1,2,1,";
        kk += "2,2,4,2,1,2,1,1,2,1,2,1,";
        kk += "2,1,2,2,1,2,2,1,2,1,1,2,";
        //1881
        kk += "1,2,1,2,1,2,5,2,2,1,2,1,";
        kk += "1,2,1,2,1,2,1,2,2,1,2,2,";
        kk += "1,1,2,1,1,2,1,2,2,2,1,2,";
        kk += "2,1,1,2,3,2,1,2,2,1,2,2,";
        kk += "2,1,1,2,1,1,2,1,2,1,2,2,";
        kk += "2,1,2,1,2,1,1,2,1,2,1,2,";
        kk += "2,2,1,5,2,1,1,2,1,2,1,2,";
        kk += "2,1,2,2,1,2,1,1,2,1,2,1,";
        kk += "2,1,2,2,1,2,1,2,1,2,1,2,";
        kk += "1,5,2,1,2,2,1,2,1,2,1,2,";
        //1891
        kk += "1,2,1,2,1,2,1,2,2,1,2,2,";
        kk += "1,1,2,1,1,5,2,2,1,2,2,2,";
        kk += "1,1,2,1,1,2,1,2,1,2,2,2,";
        kk += "1,2,1,2,1,1,2,1,2,1,2,2,";
        kk += "2,1,2,1,5,1,2,1,2,1,2,1,";
        kk += "2,2,2,1,2,1,1,2,1,2,1,2,";
        kk += "1,2,2,1,2,1,2,1,2,1,2,1,";
        kk += "2,1,5,2,2,1,2,1,2,1,2,1,";
        kk += "2,1,2,1,2,1,2,2,1,2,1,2,";
        kk += "1,2,1,1,2,1,2,5,2,2,1,2,";
        //1901
        kk += "1,2,1,1,2,1,2,1,2,2,2,1,";
        kk += "2,1,2,1,1,2,1,2,1,2,2,2,";
        kk += "1,2,1,2,3,2,1,1,2,2,1,2,";
        kk += "2,2,1,2,1,1,2,1,1,2,2,1,";
        kk += "2,2,1,2,2,1,1,2,1,2,1,2,";
        kk += "1,2,2,4,1,2,1,2,1,2,1,2,";
        kk += "1,2,1,2,1,2,2,1,2,1,2,1,";
        kk += "2,1,1,2,2,1,2,1,2,2,1,2,";
        kk += "1,5,1,2,1,2,1,2,2,2,1,2,";
        kk += "1,2,1,1,2,1,2,1,2,2,2,1,";
        //1911
        kk += "2,1,2,1,1,5,1,2,2,1,2,2,";
        kk += "2,1,2,1,1,2,1,1,2,2,1,2,";
        kk += "2,2,1,2,1,1,2,1,1,2,1,2,";
        kk += "2,2,1,2,5,1,2,1,2,1,1,2,";
        kk += "2,1,2,2,1,2,1,2,1,2,1,2,";
        kk += "1,2,1,2,1,2,2,1,2,1,2,1,";
        kk += "2,3,2,1,2,2,1,2,2,1,2,1,";
        kk += "2,1,1,2,1,2,1,2,2,2,1,2,";
        kk += "1,2,1,1,2,1,5,2,2,1,2,2,";
        kk += "1,2,1,1,2,1,1,2,2,1,2,2,";
        //1921
        kk += "2,1,2,1,1,2,1,1,2,1,2,2,";
        kk += "2,1,2,2,3,2,1,1,2,1,2,2,";
        kk += "1,2,2,1,2,1,2,1,2,1,1,2,";
        kk += "2,1,2,1,2,2,1,2,1,2,1,1,";
        kk += "2,1,2,5,2,1,2,2,1,2,1,2,";
        kk += "1,1,2,1,2,1,2,2,1,2,2,1,";
        kk += "2,1,1,2,1,2,1,2,2,1,2,2,";
        kk += "1,5,1,2,1,1,2,2,1,2,2,2,";
        kk += "1,2,1,1,2,1,1,2,1,2,2,2,";
        kk += "1,2,2,1,1,5,1,2,1,2,2,1,";
        //1931
        kk += "2,2,2,1,1,2,1,1,2,1,2,1,";
        kk += "2,2,2,1,2,1,2,1,1,2,1,2,";
        kk += "1,2,2,1,6,1,2,1,2,1,1,2,";
        kk += "1,2,1,2,2,1,2,2,1,2,1,2,";
        kk += "1,1,2,1,2,1,2,2,1,2,2,1,";
        kk += "2,1,4,1,2,1,2,1,2,2,2,1,";
        kk += "2,1,1,2,1,1,2,1,2,2,2,1,";
        kk += "2,2,1,1,2,1,4,1,2,2,1,2,";
        kk += "2,2,1,1,2,1,1,2,1,2,1,2,";
        kk += "2,2,1,2,1,2,1,1,2,1,2,1,";
        //1941
        kk += "2,2,1,2,2,4,1,1,2,1,2,1,";
        kk += "2,1,2,2,1,2,2,1,2,1,1,2,";
        kk += "1,2,1,2,1,2,2,1,2,2,1,2,";
        kk += "1,1,2,4,1,2,1,2,2,1,2,2,";
        kk += "1,1,2,1,1,2,1,2,2,2,1,2,";
        kk += "2,1,1,2,1,1,2,1,2,2,1,2,";
        kk += "2,5,1,2,1,1,2,1,2,1,2,2,";
        kk += "2,1,2,1,2,1,1,2,1,2,1,2,";
        kk += "2,2,1,2,1,2,3,2,1,2,1,2,";
        kk += "2,1,2,2,1,2,1,1,2,1,2,1,";
        //1951
        kk += "2,1,2,2,1,2,1,2,1,2,1,2,";
        kk += "1,2,1,2,4,2,1,2,1,2,1,2,";
        kk += "1,2,1,1,2,2,1,2,2,1,2,2,";
        kk += "1,1,2,1,1,2,1,2,2,1,2,2,";
        kk += "2,1,4,1,1,2,1,2,1,2,2,2,";
        kk += "1,2,1,2,1,1,2,1,2,1,2,2,";
        kk += "2,1,2,1,2,1,1,5,2,1,2,2,";
        kk += "1,2,2,1,2,1,1,2,1,2,1,2,";
        kk += "1,2,2,1,2,1,2,1,2,1,2,1,";
        kk += "2,1,2,1,2,5,2,1,2,1,2,1,";
        //1961
        kk += "2,1,2,1,2,1,2,2,1,2,1,2,";
        kk += "1,2,1,1,2,1,2,2,1,2,2,1,";
        kk += "2,1,2,3,2,1,2,1,2,2,2,1,";
        kk += "2,1,2,1,1,2,1,2,1,2,2,2,";
        kk += "1,2,1,2,1,1,2,1,1,2,2,1,";
        kk += "2,2,5,2,1,1,2,1,1,2,2,1,";
        kk += "2,2,1,2,2,1,1,2,1,2,1,2,";
        kk += "1,2,2,1,2,1,5,2,1,2,1,2,";
        kk += "1,2,1,2,1,2,2,1,2,1,2,1,";
        kk += "2,1,1,2,2,1,2,1,2,2,1,2,";
        //1971
        kk += "1,2,1,1,5,2,1,2,2,2,1,2,";
        kk += "1,2,1,1,2,1,2,1,2,2,2,1,";
        kk += "2,1,2,1,1,2,1,1,2,2,2,1,";
        kk += "2,2,1,5,1,2,1,1,2,2,1,2,";
        kk += "2,2,1,2,1,1,2,1,1,2,1,2,";
        kk += "2,2,1,2,1,2,1,5,2,1,1,2,";
        kk += "2,1,2,2,1,2,1,2,1,2,1,1,";
        kk += "2,2,1,2,1,2,2,1,2,1,2,1,";
        kk += "2,1,1,2,1,6,1,2,2,1,2,1,";
        kk += "2,1,1,2,1,2,1,2,2,1,2,2,";
        //1981
        kk += "1,2,1,1,2,1,1,2,2,1,2,2,";
        kk += "2,1,2,3,2,1,1,2,2,1,2,2,";
        kk += "2,1,2,1,1,2,1,1,2,1,2,2,";
        kk += "2,1,2,2,1,1,2,1,1,5,2,2,";
        kk += "1,2,2,1,2,1,2,1,1,2,1,2,";
        kk += "1,2,2,1,2,2,1,2,1,2,1,1,";
        kk += "2,1,2,2,1,5,2,2,1,2,1,2,";
        kk += "1,1,2,1,2,1,2,2,1,2,2,1,";
        kk += "2,1,1,2,1,2,1,2,2,1,2,2,";
        kk += "1,2,1,1,5,1,2,1,2,2,2,2,";
        //1991
        kk += "1,2,1,1,2,1,1,2,1,2,2,2,";
        kk += "1,2,2,1,1,2,1,1,2,1,2,2,";
        kk += "1,2,5,2,1,2,1,1,2,1,2,1,";
        kk += "2,2,2,1,2,1,2,1,1,2,1,2,";
        kk += "1,2,2,1,2,2,1,5,2,1,1,2,";
        kk += "1,2,1,2,2,1,2,1,2,2,1,2,";
        kk += "1,1,2,1,2,1,2,2,1,2,2,1,";
        kk += "2,1,1,2,3,2,2,1,2,2,2,1,";
        kk += "2,1,1,2,1,1,2,1,2,2,2,1,";
        kk += "2,2,1,1,2,1,1,2,1,2,2,1,";
        //2001
        kk += "2,2,2,3,2,1,1,2,1,2,1,2,";
        kk += "2,2,1,2,1,2,1,1,2,1,2,1,";
        kk += "2,2,1,2,2,1,2,1,1,2,1,2,";
        kk += "1,5,2,2,1,2,1,2,2,1,1,2,";
        kk += "1,2,1,2,1,2,2,1,2,2,1,2,";
        kk += "1,1,2,1,2,1,5,2,2,1,2,2,";
        kk += "1,1,2,1,1,2,1,2,2,2,1,2,";
        kk += "2,1,1,2,1,1,2,1,2,2,1,2,";
        kk += "2,2,1,1,5,1,2,1,2,1,2,2,";
        kk += "2,1,2,1,2,1,1,2,1,2,1,2,";
        //2011
        kk += "2,1,2,2,1,2,1,1,2,1,2,1,";
        kk += "2,1,6,2,1,2,1,1,2,1,2,1,";
        kk += "2,1,2,2,1,2,1,2,1,2,1,2,";
        kk += "1,2,1,2,1,2,1,2,5,2,1,2,";
        kk += "1,2,1,1,2,1,2,2,2,1,2,2,";
        kk += "1,1,2,1,1,2,1,2,2,1,2,2,";
        kk += "2,1,1,2,3,2,1,2,1,2,2,2,";
        kk += "1,2,1,2,1,1,2,1,2,1,2,2,";
        kk += "2,1,2,1,2,1,1,2,1,2,1,2,";
        kk += "2,1,2,5,2,1,1,2,1,2,1,2,";
        //2021
        kk += "1,2,2,1,2,1,2,1,2,1,2,1,";
        kk += "2,1,2,1,2,2,1,2,1,2,1,2,";
        kk += "1,5,2,1,2,1,2,2,1,2,1,2,";
        kk += "1,2,1,1,2,1,2,2,1,2,2,1,";
        kk += "2,1,2,1,1,5,2,1,2,2,2,1,";
        kk += "2,1,2,1,1,2,1,2,1,2,2,2,";
        kk += "1,2,1,2,1,1,2,1,1,2,2,2,";
        kk += "1,2,2,1,5,1,2,1,1,2,2,1,";
        kk += "2,2,1,2,2,1,1,2,1,1,2,2,";
        kk += "1,2,1,2,2,1,2,1,2,1,2,1,";
        //2031
        kk += "2,1,5,2,1,2,2,1,2,1,2,1,";
        kk += "2,1,1,2,1,2,2,1,2,2,1,2,";
        kk += "1,2,1,1,2,1,5,2,2,2,1,2,";
        kk += "1,2,1,1,2,1,2,1,2,2,2,1,";
        kk += "2,1,2,1,1,2,1,1,2,2,1,2,";
        kk += "2,2,1,2,1,4,1,1,2,1,2,2,";
        kk += "2,2,1,2,1,1,2,1,1,2,1,2,";
        kk += "2,2,1,2,1,2,1,2,1,1,2,1,";
        kk += "2,2,1,2,5,2,1,2,1,2,1,1,";
        kk += "2,1,2,2,1,2,2,1,2,1,2,1,";
        //2041
        kk += "2,1,1,2,1,2,2,1,2,2,1,2,";
        kk += "1,5,1,2,1,2,1,2,2,2,1,2,";
        kk += "1,2,1,1,2,1,1,2,2,1,2,2";
        var arr = new Array();
        arr = kk.split(",");
        return arr;
    }
    //현재월에서 +-월의 마지막날을 찾는 function
    function gfnNowLastDay(intNum) {
        var objDate2 = new Date();
        objDate2.addMonth(intNum + 1);
        objDate2.setDate(1);
        objDate2.addDate(-1);
        var last_date = objDate2.toFormatString("%Y%m%d");
        return last_date;
    }
    //현재월에서 +-월의 첫날을 찾는 function
    function gfnNowFirstDay(intNum) {
        var objDate2 = new Date();
        objDate2.addMonth(intNum);
        objDate2.setDate(1);
        objDate2.addDate(0);
        var first_date = objDate2.toFormatString("%Y%m%d");
        return first_date;
    }
    /*******************************************************************************
     * Function명 : gfnTodayDiv
     * 설명          : 해당 PC의 오늘 날짜를 가져온다. (년/월/일 사이에 구분자를 원하는 형태로)
     * parameter  : strDel   구분자
     * return        : string
     ******************************************************************************/
    function gfnTodayDiv(strDel) {
        var strToday = "";
        var objDate = new Date();
        var strToday = objDate.getFullYear();
        strToday = strToday + strDel + gfnRight("0" + (objDate.getMonth() + 1), 2);
        strToday = strToday + strDel + gfnRight("0" + objDate.getDate(), 2);
        return strToday;
    }
    /*음력 알고리즘..끝*/
    var today = new Date(); // 오늘 날짜
        /*
            드레그앤 드롭
        */
//        $('#yearSelect').change(function () {
//            initToday();
//            today = new Date(parseInt($("#yearSelect").val()), today.getMonth(), today.getDate());
//            buildCalendar();
//            if ($(this).val() == "2030" && $("#monthSelect").val() == "12") {
//                $("#nextButton").css("display", "none");
//            } else if ($(this).val() == "2017" && $("#monthSelect").val() == "1") {
//                $("#preButton").css("display", "none");
//            } else {
//                $("#preButton").css("display", "block");
//                $("#nextButton").css("display", "block");
//            }
////            update();
//        }); //연도 선택
//        $('#monthSelect').change(function () {
//            initToday();
//            today = new Date(parseInt($("#yearSelect").val()), parseInt($("#monthSelect").val()) - 1, today.getDate());
//            buildCalendar();
//            if ($("#yearSelect").val() == "2030" && $(this).val() == "12") {
//                $("#nextButton").css("display", "none");
//            } else if ($("#yearSelect").val() == "2017" && $(this).val() == "1") {
//                $("#preButton").css("display", "none");
//            } else {
//                $("#preButton").css("display", "block");
//                $("#nextButton").css("display", "block");
//            }
////            update();
//        }); // 달 선택
//        $('#yearSelect').val(today.getFullYear()).attr("selected", "selected");
//        $('#monthSelect').val(today.getMonth() + 1).attr("selected", "selected");

    function update() {
        $.ajax({
            type: "POST",
            url: "json/holiday.json",
            dataType: "JSON",
            success: function(data) {
                var dateArr = new Array();
                var titleArr = new Array();
                $.each(data, function(index, item) {
                    dateArr.push(item.날짜);
                    titleArr.push(item.이벤트);
                });
                buildCalendar(dateArr, titleArr);
                initToday();
            },
            error: function(req) {
                alert("상태 : " + req.status + ", " + req.responseText + ", error : " + req.error);
            }, 
            beforeSend: function () {
                    var width = 0;
                    var height = 0;
                    var left = 0;
                    var top = 0;

                    width = 50;
                    height = 50;

                    top = ( $(window).height() - height ) / 2 + $(window).scrollTop();
                    left = ( $(window).width() - width ) / 2 + $(window).scrollLeft();

                    if($("#div_ajax_load_image").length != 0) {
                           $("#div_ajax_load_image").css({
                                  "top": top+"px",
                                  "left": left+"px"
                           });
                           $("#div_ajax_load_image").show();
                    }
                    else {
                           $('body').append('<div id="div_ajax_load_image" style="position:absolute; top:' + top + 'px; left:' + left + 'px; width:' + width + 'px; height:' + height + 'px; z-index:9999; background:#f0f0f0; filter:alpha(opacity=50); opacity:alpha*0.5; margin:auto; padding:0; "><img src="img/loadingImg/ajax_loader6.gif" style="width:50px; height:50px;"></div>');
                    }
             }, 
            complete: function () {
                           $("#div_ajax_load_image").hide();  
             }
        });
    }

    function dateToFormat(sendCal) {
        var dateStr = "";
        if ((sendCal.getMonth() + 1) / 10 < 1) {
            if (sendCal.getDate() / 10 < 1) {
                dateStr = sendCal.getFullYear() + "0" + (sendCal.getMonth() + 1) + "0" + sendCal.getDate();
            } else {
                dateStr = sendCal.getFullYear() + "0" + (sendCal.getMonth() + 1) + "" + sendCal.getDate();
            }
        } else {
            if (sendCal.getDate() / 10 < 1) {
                dateStr = sendCal.getFullYear() + "" + (sendCal.getMonth() + 1) + "0" + sendCal.getDate();
            } else {
                dateStr = sendCal.getFullYear() + "" + (sendCal.getMonth() + 1) + "" + sendCal.getDate();
            }
        }
        return dateStr;
    }

    function initToday() {
        $('tr').children().each(function(i) {
            if ($(this).text() == initDay.getDate() && $('#yearSelect option:selected').val() == initDay.getFullYear() && $('#monthSelect option:selected').val() == initDay.getMonth() + 1) {
//                $(this).css("background-color", "yellow");
                $(this).find('.dayNum').css("border", "2px solid red").css("border-radius", "22px");
            }
            for (let item of scheSet.keys()) {
                if (item == dateToFormat(initDay)) {
                    if ($('#yearSelect option:selected').val() == initDay.getFullYear() && $('#monthSelect option:selected').val() == initDay.getMonth() + 1) {
//                        $('#date' + initDay.getDate()).css("backgroundColor", "green");
                    }
                }
            }
        });
        voteMeeting(cal_date);
    }

    function prevCalendar() {
        // 이전 달을 today에 값을 저장하고 달력을 뿌려줍니다.
        today = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());
        $('#yearSelect').val(today.getFullYear()).attr("selected", "selected");
        $('#monthSelect').val(today.getMonth() + 1).attr("selected", "selected");
        if ($("#yearSelect").val() == "2017" && $("#monthSelect").val() == "1") {
            $("#preButton").css("display", "none");
        } else {
            $("#nextButton").css("display", "block");
        }
        update();
    }

    function nextCalendar() {
        // 다음 달을 today에 값을 저장하고 달력을 뿌려줍니다.
        today = new Date(today.getFullYear(), today.getMonth() + 1, today.getDate());
        //            console.log(today);
        $('#yearSelect').val(today.getFullYear()).attr("selected", "selected");
        $('#monthSelect').val(today.getMonth() + 1).attr("selected", "selected");
        if ($("#yearSelect").val() == "2030" && $("#monthSelect").val() == "12") {
            $("#nextButton").css("display", "none");
        } else {
            $("#preButton").css("display", "block");
        }
        update();
    }

    function getDayInfo(a) { // 선택한 날짜 정보를 얻기 위한 함수
        if (a != null) {
            var yearInfo = $("#yearSelect").val() + "";
            var monthInfo = $("#monthSelect").val() + "";
            var dayInfo = $(a).attr("id").substr(4, $(a).attr("id").length - 4) + "";
            if (monthInfo.length == 1) {
                monthInfo = "0" + monthInfo;
            }
            if (dayInfo.length == 1) {
                dayInfo = "0" + dayInfo;
            }
            //                scheArr[0] = yearInfo + monthInfo;
            var selectDate = yearInfo + monthInfo + dayInfo;
            
            /*  ==========  날짜 선택해서 색깔 바꿔주는 문 ============== */
            if (selectDate < dateToFormat(initDay)) {
            } else {
                if ($(a).find(".choiceDate").css('width') != undefined) {
                    $(a).find(".choiceDate").remove();
                    scheSet.delete(yearInfo + monthInfo + dayInfo);
                    for (let item of voteSet.keys()) {
                        if (item.split("-")[0] == (yearInfo + monthInfo + dayInfo)) {
                            $(a).css("backgroundColor", "#ff8080");
                        }
                    }
                    for (let item of voteSet.keys()) {
                        if (item.split("-")[0] == (yearInfo + monthInfo + dayInfo)) {
                            $(a).css("backgroundColor", "#00ff80");
                        }
                    }
                    // 생일표시
                    for (let item of birthSet.keys()) {
                        if (item.split("-")[0].substr(2, 4) == (monthInfo + dayInfo)) {
                            $(a).css("backgroundColor", "#0080ff");
                            console.log(monthInfo + dayInfo);
                        }
                    }
                    initToday();
                } else {
                    $(a).append('<div class="choiceDate"> </div>');
                    scheSet.add(yearInfo + monthInfo + dayInfo);
                    console.log(selectDate);
                }
            }
        }
    }

    //  ============= 날짜 선택하고 스케줄 추가 함수 ==========
    function addSchedule() {
        if (scheSet.size == 0) {
            alert("일정이 선택 되지 않았습니다.");
            return;
        }

        $("#modal").css("display", "block");
        $("#titleAdd").css("display", "block");
        $("#blindCover").css("display", "block");

        var a = "";
        for (let item of scheSet.keys()) console.log(item);
        
        var times = [];
        var value="";
        for(var i = 0; i <25; i++){
            if(i<10){
                value="0"+i;
            }else{
                value=i;
            }
            times[i] = "<option id=time"+i+" value="+value+">"+value+"</option>";
        }
        $("#scheTime").append(times.join(''));
    }


    // ================ 요넘이 캘린더 그려주는 애. ================ 
    $(document).ready(function(){
        $('#yearSelect').change(function () {
            initToday();
            today = new Date(parseInt($("#yearSelect").val()), today.getMonth(), today.getDate());
            buildCalendar();
            if ($(this).val() == "2030" && $("#monthSelect").val() == "12") {
                $("#nextButton").css("display", "none");
            } else if ($(this).val() == "2017" && $("#monthSelect").val() == "1") {
                $("#preButton").css("display", "none");
            } else {
                $("#preButton").css("display", "block");
                $("#nextButton").css("display", "block");
            }
//            update();
        }); //연도 선택
        $('#monthSelect').change(function () {
            initToday();
            today = new Date(parseInt($("#yearSelect").val()), parseInt($("#monthSelect").val()) - 1, today.getDate());
            buildCalendar();
            if ($("#yearSelect").val() == "2030" && $(this).val() == "12") {
                $("#nextButton").css("display", "none");
            } else if ($("#yearSelect").val() == "2017" && $(this).val() == "1") {
                $("#preButton").css("display", "none");
            } else {
                $("#preButton").css("display", "block");
                $("#nextButton").css("display", "block");
            }
//            update();
        }); // 달 선택
        $('#yearSelect').val(today.getFullYear()).attr("selected", "selected");
        $('#monthSelect').val(today.getMonth() + 1).attr("selected", "selected");
        $("#yearSelect option:selected").val(today.getFullYear());
        $("#monthSelect").val(today.getMonth()+1).attr("selected","selected");
        update();
        console.log(today);
    });
    
    function buildCalendar(dateArr, titleArr, memChoiceArr) {
        var nMonth = new Date(today.getFullYear(), today.getMonth(), 1); // 이번 달의 첫째 날
        var lastDate = new Date(today.getFullYear(), today.getMonth() + 1, 0); // 이번 달의 마지막 날
        var tblCalendar = document.getElementById("calendar"); // 테이블 달력을 만들 테이블
        var tblCalendarYM = document.getElementById("calendarYM"); // yyyy년 m월 출력할 곳
        var dateParam = "";
        var dateColor = new Date();
        var holiday = gfnGetHolidays(today.getFullYear());
        var t = 0;
        var countHoliday = 0;
        while (tblCalendar.rows.length > 2) {
            tblCalendar.deleteRow(tblCalendar.rows.length - 1);
        }
        var row = null;
        row = tblCalendar.insertRow();
        var cnt = 0;
        // 1일이 시작되는 칸을 맞추어 줌
        for (i = 0; i < nMonth.getDay(); i++) {
            cell = row.insertCell();
            cnt = cnt + 1;
        }
        // =====================    달력 출력하는 코드!    ==============
        for (calDay = 1; calDay <= lastDate.getDate(); calDay++) { // 1일부터 마지막 일까지
            cell = row.insertCell();
            $(cell).attr("id", "date" + calDay);
            $(cell).attr("onclick", "getDayInfo(this)");
            $(cell).attr("style", "cursor:pointer");
            initToday();
            
            if ((today.getMonth() + 1) / 10 < 1) { // 월처리
                if (calDay / 10 < 1) {
                    dateParam = today.getFullYear() + "0" + (today.getMonth() + 1) + "0" + calDay;
                } // dateParam은 원래 2017712에서  7앞에 0을 넣는다. 20170712
                else {
                    dateParam = today.getFullYear() + "0" + (today.getMonth() + 1) + "" + calDay;
                }
            } else {
                if (calDay / 10 < 1) { // 일처리
                    dateParam = today.getFullYear() + "" + (today.getMonth() + 1) + "0" + calDay;
                } else {
                    dateParam = today.getFullYear() + "" + (today.getMonth() + 1) + "" + calDay;
                }
            }

            for (let item of scheSet.keys()) {
                if (item == dateParam) {
                    $('#date' + calDay).append('<div class="choiceDate"> </div>');// 선택했을때 초록색으로 바꿔주는 부분!
                }
            } //선택한 날짜 초록색으로 표기
            
            var saveSolar = gfnSolar2Lunar(dateParam);
            dateColor.setFullYear(today.getFullYear());
            dateColor.setMonth(today.getMonth());
            dateColor.setDate(calDay);
            if (dateColor.getDay() == 6) {
                cell.innerHTML += "<div class='saturday dayNum' style='color:blue;'>" + calDay + "</div>";
            } else if (dateColor.getDay() == 0) {
                cell.innerHTML += "<div class='sunday dayNum'>" + calDay + "</div>";
                $('.sunday').css('color', 'red');
            } else {
                cell.innerHTML += "<div class='dayNum'>" + calDay + "</div>";
            }
            if (calDay % 9 == 0) cell.innerHTML += "<div style='font-size:1px;'>" + saveSolar.substr(5, 2) + "." + saveSolar.substr(7, 2) + "</div>";
            
            // 확정된 일정표시
            for (let item of scheduleSet.keys()) {
                if (item.split("-")[0] == dateParam) {
                    cell.innerHTML += "<div class='votedSchedule' style='font-size:13px'>" + item.split("-")[1] + "</div>";
                }
            }
            
            // 미확정된 일정표시
            for (let item of voteSet.keys()) {
                if (item.split("-")[0] == dateParam) {
                    cell.innerHTML += "<div class='voteSchedule' style='font-size:13px'>" + item.split("-")[1] + "</div>";
                }
            }
            // 생일표시
            for (let item of birthSet.keys()) {
                if (item.split("-")[0].substr(2, 4) == dateParam.substr(4)) {
                    cell.innerHTML += "<div class='memberBirthDay' style='font-size:13px'>" + item.split("-")[1] + "(" + item.split("-")[2] + ")님의 생일</div>";
                    console.log("#date" + parseInt(dateParam.substr(6)));
                    $("#date" + parseInt(dateParam.substr(6))).css("background-color", "#0080ff");
                }
            }
            for (var markHoliday = 0; markHoliday < holiday.length; markHoliday++) {
                var whatHoliday;
                if (holiday[markHoliday].substr(0, 8) == parseInt(dateParam)) {
                    whatHoliday = holiday[markHoliday].substr(8, holiday[markHoliday].length - 8);
                    cell.innerHTML += "<div class='holi'>" + whatHoliday + "</div>";
                    $('.holi').css("color", "red");
                    $('.holi').prevAll().css("color", "red");
                }
            }

            if (dateArr != null) {
                for (var dateNum = 0; dateNum < dateArr.length; dateNum++) {
                    if (dateArr[dateNum] == dateParam) {
                        cell.innerHTML += "<div class='inputHoli'>" + titleArr[dateNum] + "</div>";
                        $('.inputHoli').css("color", "red");
                        $('.inputHoli').prevAll().css("color", "red");
                    }
                }
            }
            cnt = cnt + 1;
            if (cnt % 7 == 0) {
                // 1주일이 7일 이므로                 
                row = calendar.insertRow(); // 줄 추가
            }
        }
    }

    //  ================================ 달력 출력 끝! ================================
    
// ================ 개인일정 뽑아주는 함수! =====================
    
    $(document).ready(function(){
        $.ajax({
             type:'post'
            ,url:'myCal.do'
            ,dataType : "json"
            ,success : function(data){
                console.log(data);
                var str ="";
                var tempDataSet = new Set();
              $.each(data, function(index, item){
                  tempDataSet.add(item.myCalDate + "-" + item.myCalContents + "-" + item.myCalTime + "-" + item.myCalIndex);
//                  console.log(item.myCalIndex);
//                  console.log(item.myCalContents);
//                  console.log(item.myCalTime);
                
//                  var calDate = item.myCalDate.split(",");
//                  var calSubStr1 = calDate[0].substr(2,8);
//                  var calSubStr2 = calDate[calDate.length-2].substr(2,8);                  
//                  
//                  if(calDate.length != 2){
//                     str+="<div class='swiper-slide'><div class='schedules scheList1'>"+calSubStr1+"~"+calSubStr2+"</div>";
//                  } else {
//                    str+="<div class='swiper-slide'><div class='schedules scheList1'>"+calSubStr1+"</div>";
//                  }
//                  str+="<div class='schedules scheList2'>"+item.myCalContents+"</div>";
//                  str+="<div class='schedules scheList3'>"+item.myCalTime+" 시 예약<button class='scheList' name='delete"+item.myCalIndex+"' id='delete"+item.myCalIndex+"' onclick=scheDelete(this)>-</button></div></div>";
              });
                
                var tempDataArray = Array.from(tempDataSet).sort();
                console.log(tempDataArray);
                var tempYear = 0;
                
                str+="<div class='swiper-slide'>";
                str+="<div class='fiveSwip''>";
                var tempDataCount = 0;
                for(var i = 0; i < tempDataArray.length; i++)
                {
                    var calDate = tempDataArray[i].split("-")[0].split(",");
                    var calSubStr1 = calDate[0].substr(4,8);
                    var calSubStr2 = calDate[calDate.length-2].substr(4,8); 
                    
                    if(tempDataCount >=5){
                        str+="</div>";
                        str+="</div><div class='swiper-slide'>";
                        str+="<div class='fiveSwip'>";
                        tempDataCount = 0;
                    }

                    if(parseInt(calDate[0].substr(0,4)) > tempYear)
                    {
                        str+="<div class='fiveSwip scheYear'>"+calDate[0].substr(0,4)+"년</div>";
                        tempYear = parseInt(calDate[0].substr(0,4));
                        tempDataCount++;
                    }

                    if(calDate.length != 2){
                        str+="<div class='fiveSwip mySche'><div class='schedules scheList1'>"+calSubStr1.substr(0,2)+"월";
                        str+=calSubStr1.substr(2,2)+"일"+"~"+calSubStr2.substr(0,2)+"월"+calSubStr2.substr(2,2)+"일"+"</div>";
                    } else {
                        str+="<div class='fiveSwip mySche'><div class='schedules scheList1'>"+calSubStr1.substr(0,2)+"월";
                        str+=calSubStr1.substr(2,2)+"일"+"</div>";
                    }
                    str+="<div class='schedules scheList2'>"+tempDataArray[i].split("-")[1]+"</div>";
                    str+="<div class='schedules scheList3'>"+tempDataArray[i].split("-")[2]+" 시 예약<button class='scheList delBtn' id='delete"+tempDataArray[i].split("-")[3]+"' onclick=scheDelete(this)>-</button></div></div>";
                    tempDataCount++;
                }
                str+="</div>";
                str+="</div>";
                
                $(".leftUp .swiper-wrapper").append(str);
                
                var swiper = new Swiper('.leftUp .swiper-container', {
                    pagination: '.leftUp .swiper-pagination',
                    direction: 'vertical',
                    slidesPerView: 1,
                    paginationClickable: true,
//                    centeredSlides: true,
                    spaceBetween: 20,
                    mousewheelControl: true
                });  
            },
            error:function(req){ 
             alert("상태 : " + req.status + ", " + req.responseText + ", error : " + req.error);
            }, beforeSend: function () {
                    var width = 0;
                    var height = 0;
                    var left = 0;
                    var top = 0;

                    width = 50;
                    height = 50;

                    top = ( $(window).height() - height ) / 2 + $(window).scrollTop();
                    left = ( $(window).width() - width ) / 2 + $(window).scrollLeft();

                    if($("#div_ajax_load_image").length != 0) {
                           $("#div_ajax_load_image").css({
                                  "top": top+"px",
                                  "left": left+"px"
                           });
                           $("#div_ajax_load_image").show();
                    }
                    else {
                           $('body').append('<div id="div_ajax_load_image" style="position:absolute; top:' + top + 'px; left:' + left + 'px; width:' + width + 'px; height:' + height + 'px; z-index:9999; background:#f0f0f0; filter:alpha(opacity=50); opacity:alpha*0.5; margin:auto; padding:0; "><img src="img/loadingImg/ajax_loader6.gif" style="width:50px; height:50px;"></div>');
                    }
             }
             , complete: function () {
                $("#div_ajax_load_image").hide();
             }
        });
    });
    
//    var i =0;
//    function moreShow(){
//        alert("!");
//        $("#privSchedule").append(
//            $.ajax({
//                 type:'post'
//                ,url:'myCal.do'
//                ,dataType : "json"
//                
//                ,success : function(data){
//                    console.log(data);
//                    console.log(i+=1);
//                  $.each(data, function(index, item){
//                      var calDate = item.myCalDate.split(",");
//                      if(calDate.length != 2){
//                         document.getElementById("myCalDate").innerHTML+=
//                             "<div class='schedules scheList'>"
//                             +calDate[0]
//                             +"~"
//                             +calDate[calDate.length-2]
//                             +"</div></br>";
//                      } else {
//                        document.getElementById("myCalDate").innerHTML+=
//                            "<div class='schedules scheList'>"
//                            +calDate[0]
//                            +"</div></br>";
//                      }
//                      
//                      document.getElementById("myCalContents").innerHTML+=
//                          "<div class='schedules scheList'>"
//                          +item.myCalContents
//                          +"</div></br>";
//                      
//                      document.getElementById("myCalTime").innerHTML+=
//                          "<div class='schedules scheList'>"
//                          +item.myCalTime+" 시 예약"
//                          +"<button class='scheList' name='delete"
//                          +item.myCalIndex
//                          +"' id='delete"
//                          +item.myCalIndex
//                          +"' onclick=scheDelete(this)>-</button></div></br>";
//                  });
//                },
//                error:function(req){ 
//                 alert("상태 : " + req.status + ", " + req.responseText + ", error : " + req.error);
//                }
//        }));
//    }
    
//    function moreShow(){
//        alert("!");
//        var i=0;
//        
//        $($.ajax({
//                 type:'post'
//                ,url:'myCal.do'
//                ,dataType : "json"
//                
//                ,success : function(data){
//                    console.log(data);
//                  $.each(data, function(index, item){
//                      var calDate = item.myCalDate.split(",");
//                      if(calDate.length != 2){
//                         document.getElementById("myCalDate").innerHTML+=
//                             "<div class='schedules scheList'>"
//                             +calDate[0]
//                             +"~"
//                             +calDate[calDate.length-2]
//                             +"</div></br>";
//                      } else {
//                        document.getElementById("myCalDate").innerHTML+=
//                            "<div class='schedules scheList'>"
//                            +calDate[0]
//                            +"</div></br>";
//                      }
//                      
//                      document.getElementById("myCalContents").innerHTML+=
//                          "<div class='schedules scheList'>"
//                          +item.myCalContents
//                          +"</div></br>";
//                      
//                      document.getElementById("myCalTime").innerHTML+=
//                          "<div class='schedules scheList'>"
//                          +item.myCalTime+" 시 예약"
//                          +"<button class='scheList' name='delete"
//                          +item.myCalIndex
//                          +"' id='delete"
//                          +item.myCalIndex
//                          +"' onclick=scheDelete(this)>-</button></div></br>";
//                  });
//                },
//                error:function(req){ 
//                 alert("상태 : " + req.status + ", " + req.responseText + ", error : " + req.error);
//                }
//        })).append("#privSchedule");
//    }
    
// 더보기 버튼 시도!! 
//    $(window).on('load', function () {
//        load('#privSchedule', '4');
//        $(".more").on("click", function () {
//            load('#privSchedule', '4');
//        })
//    });
//    function load(id, cnt, btn) {
//        var list = id + " .scheList:not(.active)";
//        var length = $(list).length;
//        var total_cnt;
//        if (cnt < length) {
//            total_cnt = cnt;
//        } else {
//            total_cnt = length;
//            $(".more").hide();
//        }
//        $(list + ":lt(" + total_cnt + ")").addClass("active");
//    }
// 더보기 버튼 실패.......    
    
    
    
    
    
/* =============== 개인일정 삭제해주는 함수 =============== */
    function scheDelete(del){
        console.log(del);
        var deleteId = $(del).attr('id');
        console.log(deleteId);
        console.log(deleteId.split('delete'));
        var deleteNum = deleteId.split('delete');
        console.log(deleteNum[1]);
        
        $.ajax({
             type:'post'
            ,url:'scheDelete.do'
            ,dataType : "json"
            ,data: {
                deleteNum : deleteNum[1]
            }
            ,success : function(data){
                
            },
            error:function(req){
//             alert("상태 : " + req.status + ", " + req.responseText + ", error : " + req.error);
            }, beforeSend: function () {
                    var width = 0;
                    var height = 0;
                    var left = 0;
                    var top = 0;

                    width = 50;
                    height = 50;

                    top = ( $(window).height() - height ) / 2 + $(window).scrollTop();
                    left = ( $(window).width() - width ) / 2 + $(window).scrollLeft();

                    if($("#div_ajax_load_image").length != 0) {
                           $("#div_ajax_load_image").css({
                                  "top": top+"px",
                                  "left": left+"px"
                           });
                           $("#div_ajax_load_image").show();
                    }
                    else {
                           $('body').append('<div id="div_ajax_load_image" style="position:absolute; top:' + top + 'px; left:' + left + 'px; width:' + width + 'px; height:' + height + 'px; z-index:9999; background:#f0f0f0; filter:alpha(opacity=50); opacity:alpha*0.5; margin:auto; padding:0; "><img src="img/loadingImg/ajax_loader6.gif" style="width:50px; height:50px;"></div>');
                    }
             }
             , complete: function () {
                           $("#div_ajax_load_image").hide();
             }
        });
        location.reload();
    }
    
/* ================ 단체일정 뽑아주는 함수 ================== */
    $(document).ready(function(){
        
        $.ajax({
             type:'post'
            ,url:'myGroupSchedule.do'
            ,dataType : "json"
            ,success : function(data){
                console.log(data);
                var str2="";
                var groupDataSet = new Set();
              $.each(data, function(index, item){
                  groupDataSet.add(item.calDate + "-" + item.calMemo + "-" + item.calWriter);
              });
                
                var groupDataArray = Array.from(groupDataSet).sort();
                console.log(groupDataArray);
                var groupYear = 0;
                
                str2+="<div class='swiper-slide'>";
                str2+="<div class='fiveSwip'>";
                var groupDataCount = 0;
                for(var i = 0; i < groupDataArray.length; i++){
                    var calDate = groupDataArray[i].split("-")[0].split(",");
                    var calStr1 = calDate[0].substr(4,4);
                    var calStr2 = calDate[calDate.length-1].substr(4,4);
                    
                    if(groupDataCount >=5){
                        str2+="</div>";
                        str2+="</div><div class='swiper-slide'>";
                        str2+="<div class='fiveSwip'>";
                        groupDataCount = 0;
                    }
                    
                    if(parseInt(calDate[0].substr(0,4)) > groupYear){
                        str2+="<div class='fiveSwip scheYear'>"+calDate[0].substr(0,4)+"년</div>";
                        groupYear = parseInt(calDate[0].substr(0,4));
                        groupDataCount++;
                    }
                    
                    if(calDate.length !=2){
                        str2+="<div class='fiveSwip mySche'><div class='schedules scheList1'>"+calStr1.substr(0,2)+"월";
                        str2+=calStr1.substr(2,2)+"일"+"~"+calStr2.substr(0,2)+"월"+calStr2.substr(2,2)+"일"+"</div>";
                    } else {
                        str2+="<div class='fiveSwip mySche'><div class='schedules scheList1'>"+calStr1.substr(0,2)+"월";
                        str2+=calStr1.substr(2,2)+"일"+"</div>";
                    }
                    str2+="<div class='schedules scheList2'>"+groupDataArray[i].split("-")[1]+"</div>";
                    str2+="<div class='schedules scheList3'>"+groupDataArray[i].split("-")[2]+"</div></div>";
                    groupDataCount++;
                }
                str2+="</div>";
                str2+="</div>";

                
                
                $(".leftDown .swiper-wrapper").append(str2);

                var swiper = new Swiper('.leftDown .swiper-container', {
                    pagination: '.leftDown .swiper-pagination',
                    direction: 'vertical',
                    slidesPerView: 1,
                    paginationClickable: true,
//                    centeredSlides: true,
                    spaceBetween: 5,
                    mousewheelControl: true
                });
            },
            error:function(req){
             alert("상태 : " + req.status + ", " + req.responseText + ", error : " + req.error);
            }, beforeSend: function () {
                    var width = 0;
                    var height = 0;
                    var left = 0;
                    var top = 0;

                    width = 50;
                    height = 50;

                    top = ( $(window).height() - height ) / 2 + $(window).scrollTop();
                    left = ( $(window).width() - width ) / 2 + $(window).scrollLeft();

                    if($("#div_ajax_load_image").length != 0) {
                           $("#div_ajax_load_image").css({
                                  "top": top+"px",
                                  "left": left+"px"
                           });
                           $("#div_ajax_load_image").show();
                    }
                    else {
                           $('body').append('<div id="div_ajax_load_image" style="position:absolute; top:' + top + 'px; left:' + left + 'px; width:' + width + 'px; height:' + height + 'px; z-index:9999; background:#f0f0f0; filter:alpha(opacity=50); opacity:alpha*0.5; margin:auto; padding:0; "><img src="img/loadingImg/ajax_loader6.gif" style="width:50px; height:50px;"></div>');
                    }
             }
             , complete: function () {
                           $("#div_ajax_load_image").hide();
             }
        });
    });
        
/* ==== 친구들 생일 뽑아주는 함수 ===== */
    var strBirth = "";
    $(document).ready(function() {
        $.ajax({
            type: 'post',
            url: 'myCalBirth.do',
            dataType: "json",
            success: function(data) {
                console.log(data);
                var memberBirthSet = new Set();
                
                $.each(data, function(index, item) {
                    memberBirthSet.add(item.friendBirth.substr(2, 4) + "-" + item.friendName + "-" + item.friendImg + "-" + item.friendId);
                });
                
                var memberBirthArray = Array.from(memberBirthSet).sort();
                var CurrentMonth;
//                var memBirMonth = memberBirthArray[i].split("-")[0];
                for(var i = 0; i < memberBirthArray.length; i++){
                    var birthDay = memberBirthArray[i].split("-")[0];
                    strBirth+="<div class='swiper-slide'>";
                    if (i == 0) {
                        strBirth += "<div class='fbirthList'><div><div class ='birthMonth' id='bm" + parseInt(birthDay.substr(0, 2)) + "'>&nbsp;" + parseInt(birthDay.substr(0, 2)) + "월 <div class='stick'></div></div></div>";
                        CurrentMonth = parseInt(birthDay.substr(0, 2));
                    } else if (parseInt(birthDay.substr(0, 2)) > CurrentMonth) {
                        strBirth += "<div class='fbirthList'><div><div class ='birthMonth' id='bm" + parseInt(birthDay.substr(0, 2)) + "'>&nbsp;" + parseInt(birthDay.substr(0, 2)) + "월 <div class='stick'></div></div></div>";
                        CurrentMonth = parseInt(birthDay.substr(0, 2));
                    } else {
                        strBirth += "<div class='fbirthList'><div><div class ='birthMonth' id='bm" + parseInt(birthDay.substr(0, 2)) + "'><div class='stick'>                                 </div></div></div>";
                    }
                    
                    strBirth+="<div class='myScheList'>";
                    strBirth+="<div class='fImg'><img id='friendImg' src='"+memberBirthArray[i].split("-")[2]+"'/></div>";
                    strBirth+="<div class='fInfo'><div class=fname>"+memberBirthArray[i].split("-")[1]+"</div>";
                    strBirth+="<div class=fbirth>"+memberBirthArray[i].split("-")[0].substr(1, 1)+"월";
                    strBirth+=memberBirthArray[i].split("-")[0].substr(2,3)+"일"+"</div></div></div></div></div>";
                    // memberBirthArray[i].split("-")[3] : userId
                }
                
                $(".eveLeft .swiper-wrapper").append(strBirth);
                
                 var horiSwiper = new Swiper('.eveLeft .swiper-container', {
                    pagination: '.eveLeft .swiper-pagination',
                    nextButton: '.eveLeft .swiper-button-next',
                    prevButton: '.eveLeft .swiper-button-prev',
                    slidesPerView: 3,
                    paginationClickable: true,
                    spaceBetween: 0,
                    loop: true
                });
//                console.log(memberBirthArray);
            },
            error: function(req) {
                alert("상태 : " + req.status + ", " + req.responseText + ", error : " + req.error);
            }, beforeSend: function () {
                    var width = 0;
                    var height = 0;
                    var left = 0;
                    var top = 0;

                    width = 50;
                    height = 50;

                    top = ( $(window).height() - height ) / 2 + $(window).scrollTop();
                    left = ( $(window).width() - width ) / 2 + $(window).scrollLeft();

                    if($("#div_ajax_load_image").length != 0) {
                           $("#div_ajax_load_image").css({
                                  "top": top+"px",
                                  "left": left+"px"
                           });
                           $("#div_ajax_load_image").show();
                    }
                    else {
                           $('body').append('<div id="div_ajax_load_image" style="position:absolute; top:' + top + 'px; left:' + left + 'px; width:' + width + 'px; height:' + height + 'px; z-index:9999; background:#f0f0f0; filter:alpha(opacity=50); opacity:alpha*0.5; margin:auto; padding:0; "><img src="img/loadingImg/ajax_loader6.gif" style="width:50px; height:50px;"></div>');
                    }  
             }
             , complete: function () {
                           $("#div_ajax_load_image").hide();
                
             }

        });
    });
    
  
    function voteMeeting(cal_date) {
        for (var vote = 0; vote < cal_date.length; vote++) {
            $("#date" + parseInt(cal_date[vote].substr(6, 2))).children().last().html();

            if (cal_date[vote].substr(0, 4) == $("#yearSelect option:selected").val() && parseInt(cal_date[vote].substr(4, 2)) == parseInt($("#monthSelect option:selected").val())) {
                $("#date" + parseInt(cal_date[vote].substr(6, 2))).css("backgroundColor", "red");
                $("#date" + parseInt(cal_date[vote].substr(6, 2))).children().last().append("<div>투표중..</div>");

            }
        }
    }

        
/* ============== 작성하기 버튼 ============== */
    function clickAddCal() {   
        $("#selectAnswer").html("'" + $("#calTitle").val() + "'" + "의 제목으로 일정을 추가하시겠습니까?");
        var heights = $('#contentsHeight').css('height');
        if ($("#calTitle").val() != "") {
            $('#modal').animate({
                height: heights,
            }, 300);
        }
    }
    
    
    function selectYes() {
        console.log($("#calTitle").val());
        console.log($("#calTitle").val().length);
        
        var groupId = location.href.split("=")[1];
        console.log(groupId);
        var calDate = "";
        for (let item of scheSet.keys())
            calDate += item + ","; // 달력에 날짜를 클릭했을때 (년도+월+선택한 일) + ","
        var calTitle = $("#calTitle").val();
        var calTime = $("#scheTime").val();
        if($("#calTitle").val().length == 0){
//            $("#selectAnswer").add("내용을 입력하세요.");
            alert("내용을 입력해주세요!");
        }else{
            $.ajax({
                type: 'post',
                url: 'mySchedule.do',
                data: { // 이 데이터가 서블릿으로 보내주는것이다.
                    title: calTitle,
                    calDate: calDate,
                    groupId: groupId,
                    calTime: calTime
                },
                dataType: "json",
                success: function(data) { // 이것이 서블릿에서 받는 코드.
                    console.log(data);
                },
                error: function(req) {
                    //                    alert("상태 : " + req.status + ", " + req.responseText + ", error : " + req.error);
                }, beforeSend: function () {
                        var width = 0;
                        var height = 0;
                        var left = 0;
                        var top = 0;

                        width = 50;
                        height = 50;

                        top = ( $(window).height() - height ) / 2 + $(window).scrollTop();
                        left = ( $(window).width() - width ) / 2 + $(window).scrollLeft();

                        if($("#div_ajax_load_image").length != 0) {
                               $("#div_ajax_load_image").css({
                                      "top": top+"px",
                                      "left": left+"px"
                               });
                               $("#div_ajax_load_image").show();
                        }
                        else {
                               $('body').append('<div id="div_ajax_load_image" style="position:absolute; top:' + top + 'px; left:' + left + 'px; width:' + width + 'px; height:' + height + 'px; z-index:9999; background:#f0f0f0; filter:alpha(opacity=50); opacity:alpha*0.5; margin:auto; padding:0; "><img src="img/loadingImg/ajax_loader6.gif" style="width:50px; height:50px;"></div>');
                        }
                 }
                 , complete: function () {
                               $("#div_ajax_load_image").hide();
                 }
            });
            location.reload();
        }
        
    }
    
    function selectNo() {
        $("#modal").css("display", "none");
        console.log("!!!!");
        $("#calTitle").val("");
        location.reload();
    }

    
    //=============   모달 사라짐 ==============
    function closeModal() {
        console.log("!");
        $('#blindCover').css('display', 'none');
        $('#modal').css('display', 'none');
        $('#modal input').val("");
        location.reload();

    }

    //모달 뜰떄 뒤에 까만화면 크기를....
    $(document).ready(function() {
        $('#blindCover').css("height", $(document).height());
        $('#blindCover').css("width", $(document).width());
        $(window).resize(function() {
            $('#blindCover').css("height", $(document).height());
            $('#blindCover').css("width", $(document).width());
        });
    });
    
    function reloadList(){
        location.reload();
    }

</script>
</head>

<body>
    <div id="newWrap">
      <nav class="left_nav">
        <div id="userInfo">
            <ul id="user_Img_Cover" class="nav_ul" onclick="location.href='myInfo.html'">
                <li class="nav_li">
                    <img id="user_Img" src=""/>
                </li>
                <li class="nav_li idLi">
                    <div id="user_Id"></div>
                </li>
            </ul>
        </div>
        <ul class="nav_ul" id="nav_menu">
            <li class="nav_li"><a class="nav_text" href="home.html">메인</a></li>
            <li class="nav_li"><div id="navHere"></div><a class="nav_text" href="myCalendar.html">개인</a></li>
            <li class="nav_li"><a class="nav_text" href="groupList.html">모임</a><div id="newContents">N</div></li>
            <li class="nav_li"><a class="nav_text" href="friendList.html">지인</a></li>
            <li class="nav_li"><a class="nav_text" href="qnaList.html">문의</a></li>
        </ul>
        <ul id="logout" class="nav_ul" onclick="logout()">
             <li class="nav_li"><a class="nav_text" onclick="logout();">아웃</a>
        </ul>
          
    </nav>

        <!--  ========================= NAV 밑 ========================== -->

        <div id="main_container">
            <div id="container">

                <!--
                <div class="typeText">  이쁘게 호버호버 
                    <div>
                    
                    </div>
                </div>
-->
                <!--  ========================= LEFT SIDE ========================== -->
                <div id="left-side">
                    <div class="leftUp">
                        <!-- 위 -->
                        <div class="privSchedule">
                            <div class="program txt">개인 일정</div>
                            <div class="decoLine"></div>
                        </div>
                        <div class="swiper-container">
							<div class="swiper-wrapper"></div>
							<div class="swiper-pagination"></div>
						</div>
                        <!-- ===== 더보기 버튼 ===== -->
<!--                        <button class="more" onclick=moreShow()>+</button>-->
                    </div>

                    <div class="leftDown">
                        <!-- 밑 -->
                        <div class="privSchedule">
                            <div class="program txt">단체 일정</div>
                            <div class="decoLine"></div>
                        </div>                       
                        <div class="swiper-container">
                            <div class="swiper-wrapper"></div>
                            <div class="swiper-pagination"></div>
                        </div>
                    </div>
                    
                    <div class="events">
                    <!-- 밑 감싸기-->
                        <div class="eveLeft">
                            <!-- 옆 -->
                            <div class="closeEvent">
                                <div class="closeText txt">친구 생일</div>
                                <div class="closeDeco"></div>
                            </div>
                            <div class="swiper-container">
                                <div class="swiper-wrapper"></div>
                                <div class="swiper-pagination"></div>
                                <div class="swiper-button-next"></div>
                                <div class="swiper-button-prev"></div>
                            </div>

                        </div>
                    </div>
                    
                </div>
                <!-- left-side끝 -->

                <!--  ========================= CALENDAR ========================== -->
                <!-- {달력}, {알수없는 무언가} -->
                <div id="right-side">
                    <!-- {달력} -->
                    <div class="cal">
                        <table id="calendar">
                            <tr id="yearMonth">
                                <td>
                                    <label id="preButton" onclick="prevCalendar()"><img src="img/moveIcon/left.png" style="cursor:pointer;" /></label>
                                </td>
                                <td colspan="5" align="center" id="calendarYM">
                                    <select class=" txt" id="yearSelect">
                                            <option>2017</option>
                                            <option>2018</option>
                                            <option>2019</option>
                                            <option>2020</option>
                                            <option>2021</option>
                                            <option>2022</option>
                                            <option>2023</option>
                                            <option>2024</option>
                                            <option>2025</option>
                                            <option>2026</option>
                                            <option>2027</option>
                                            <option>2028</option>
                                            <option>2029</option>
                                            <option>2030</option>
                                        </select> <span class="txt">년</span>
                                    <select class="txt" id="monthSelect">
                                            <option>1</option>
                                            <option>2</option>
                                            <option>3</option>
                                            <option>4</option>
                                            <option>5</option>
                                            <option>6</option>
                                            <option>7</option>
                                            <option>8</option>
                                            <option>9</option>
                                            <option>10</option>
                                            <option>11</option>
                                            <option>12</option>
                                        </select> <span class="txt">월</span> </td>
                                <td>
                                    <label id="nextButton" onclick="nextCalendar()"><img src="img/moveIcon/right.png" style="cursor:pointer;" /></label>
                                </td>
                            </tr>
                            <tr class="weekdays txt" style="height:30px;">
                                <td>일</td>
                                <td>월</td>
                                <td>화</td>
                                <td>수</td>
                                <td>목</td>
                                <td>금</td>
                                <td>토</td>
                            </tr>
                        </table>
                       <button class="modalButton" onclick="addSchedule()">일정추가하기</button>
                    </div>
                    
                    <!-- ============ 텍스트 입력 모달창 ============ -->
                    <div>
                        <div id="blindCover" onclick="closeModal();"></div>
                        <span id='modal' style="border:1px solid black;">
                                <div id="contentsHeight">
                                   
                                    <div id="titleAdd">
                                        <input type="text" placeholder="자신의 일정을 한줄로 써보세요." id="calTitle" maxlength="24"/> 
                                        <span style="font-size:10px">시간 선택</span>
                                        <select name="scheTime" id="scheTime"></select>
                                        <div id="groupAddBtn" onclick="clickAddCal()">작성하기</div>
                                    </div>

                                    <div id="answerBox">
                                        <div id="selectAnswer"></div>
                                        <div class="btnCenter">
                                            <div class="choiceBtn" id="yesButton" onclick="selectYes()"> 예 </div>
                                            <div class="choiceBtn" id="noButton" onclick="closeModal()"> 아니오 </div>
                                        </div>
                                    </div>
                                </div>
                            </span>

                        <div id='modal2'> </div>
                    </div>


                </div>
                <!-- right-side 끝 -->
            </div>
            <!-- contatiner 끝 -->

        </div>
    </div>
</body>

</html>
